<!doctype html>
<html lang="zh-Hans-CN">
<head>
  <meta charset="utf-8" />
  <title>KPMG Audit Compass</title>
  <base href="/AuditCompass/">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- ECharts -->
  <script src="https://unpkg.com/echarts@5/dist/echarts.min.js"></script>

  <!-- ====== å¹³å°åŸºç¡€æ ·å¼ï¼ˆæŒ‰ä½ æä¾›çš„å˜é‡/è‰²æ¿è£å‰ªä¿ç•™ï¼‰ ====== -->
  <style>
  html,body{width:100%;height:100%}
  *,*:before,*:after{box-sizing:border-box}
  html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%}
  body{margin:0;color:#000000d9;font-size:14px;
    font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";
    line-height:1.5715;background:var(--body-background)}
  :root{
    --primary-color:#1e49e2; --primary-color-opacity:rgba(30,73,226,.4);
    --deep-blue:#00338d; --base-space:16px;
    --table-head-background:#F6F8FE; --table-border:1px solid #f0f0f0;
    --warning-color:#faad14; --body-background:#f5f7fa;
    /* å…¼å®¹å†…å®¹é¡µè‡ªç”¨å˜é‡ */
    --primary:#2563eb; --primary-600:#1e40af; --muted:#64748b; --text:#0f172a;
    --bg:#f5f7fa; --card:#fff; --border:#e8e8ed; --shadow:0 6px 18px rgba(17,24,39,.08);
  }

  /* ====== é¡¶éƒ¨ Headerï¼ˆå ä½ï¼Œç±»åä¿æŒï¼Œç”¨äºæ— ç¼æ›¿æ¢ï¼‰ ====== */
  .layout-header {display:flex;align-items:center;height:48px;background:var(--primary-color);
    padding:0 16px;color:#fff;position:sticky;top:0;z-index:9999}
  .layout-header .layout-header-name{font-size:22px;font-weight:700}
  .layout-header .layout-header-project{margin-left:12px;opacity:.9}
  .layout-header .layout-header-nav{margin-left:auto;display:flex;gap:12px}

  /* ====== ä¸»å¸ƒå±€ ====== */
  .layout-main{display:flex;height:calc(100vh - 48px)}
  .sidebar{width:200px;background:#fff;border-right:1px solid #eaecef;overflow-y:auto}
  .sidebar-menu{list-style:none;margin:0;padding:8px}
  .sidebar-menu li{padding:8px 10px;border-radius:6px;cursor:pointer}
  .sidebar-menu li.active,.sidebar-menu li:hover{background:#f0f4ff}
  .main-right{flex:1;display:flex;flex-direction:column;overflow:hidden}
  .breadcrumb-bar{background:#fff;padding:6px 8px;color:#999;margin:0 var(--base-space)}
  .content-scroll{flex:1;overflow:auto}
  .content-wrap{margin:var(--base-space)}

  /* ====== å†…å®¹é¡µï¼ˆæ²¿ç”¨ä½ â€œå®Œæ•´ç‰ˆæœ¬â€çš„é£æ ¼ï¼‰ ====== */
  .container{max-width:1480px;margin:auto}
  .header{display:flex;align-items:center;gap:12px}
  .header .breadcrumb{font-size:13px;color:var(--muted)}
  .toolbar{margin-left:auto;display:flex;gap:10px}
  .btn{padding:6px 10px;border-radius:6px;border:1px solid var(--border);
    background:linear-gradient(135deg,#fff,#f9fafb);cursor:pointer;font-size:13px;transition:all .25s ease}
  .btn:hover{border-color:var(--primary);box-shadow:0 2px 6px rgba(37,99,235,.2)}
  .btn-primary{background:linear-gradient(135deg,var(--primary),var(--primary-600));color:#fff;border:none}

  .tabbar{display:flex;gap:6px;border-bottom:2px solid var(--border);margin:10px 0 16px}
  .tab{padding:10px 14px;border-radius:8px 8px 0 0;color:var(--muted);cursor:pointer}
  .tab.active{background:#fff;border:1px solid var(--border);border-bottom:0;color:var(--primary)}
  .card{background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);margin-bottom:16px;overflow:hidden}
  .card .head{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border);background:#f9fbff;position:relative}
  .card .head::before{content:"";position:absolute;left:0;top:0;width:4px;height:100%;background:var(--primary)}
  .card .title{font-weight:600;margin-left:8px}
  .card .content{padding:14px 16px}
  .filters{display:flex;flex-wrap:wrap;gap:12px;align-items:center}
  .filters label{font-size:12px;color:var(--text)}
  .select{padding:4px 8px;font-size:12px;color:var(--text);background:#fff;border:1px solid var(--border);
    border-radius:6px;min-width:100px;transition:all .25s ease;box-shadow:0 2px 5px rgba(0,0,0,.05);appearance:none}
  .select:hover{border-color:var(--primary);box-shadow:0 0 0 3px rgba(37,99,235,.15)}
  .select:focus{outline:none;border-color:var(--primary-600);box-shadow:0 0 0 3px rgba(37,99,235,.25)}
  .chart{height:300px}

  .table{width:100%;border-collapse:collapse;font-size:13px}
  .table th,.table td{border:1px solid var(--border);padding:8px;text-align:center;white-space:nowrap}
  .table th{background:#f1f5ff;color:#1e293b;font-weight:600}
  .table tr:hover td{background:#f9fbff}
  .table-tabs{display:flex;gap:10px;margin:10px 0}
  .table-tab{padding:6px 14px;border:1px solid var(--border);border-radius:8px;background:#f8fafc;color:var(--muted);cursor:pointer}
  .table-tab.active{background:var(--primary);color:#fff;border-color:var(--primary)}

  .split{display:grid;grid-template-columns:300px 1fr;gap:16px}
  .sidebar-pane{background:#fff;border:1px solid var(--border);border-radius:12px;padding:12px}
  .menu{display:flex;flex-direction:column;gap:6px}
  .menu .item{padding:8px 10px;border:1px solid var(--border);border-radius:8px;background:#eef2ff;cursor:pointer;font-size:13px}
  .menu .item.active{background:#fff;outline:2px solid var(--primary-600)}
  .small{font-size:12px;color:var(--muted)}
  .top-strip{display:grid;grid-template-columns:repeat(6,1fr);gap:10px}
  .top-item{background:#f9fafb;border:1px solid var(--border);border-radius:10px;padding:10px 12px}
  .top-item .lbl{font-size:12px;color:var(--muted)}
  .top-item .num{font-weight:700;margin-top:6px}
  .rank-list{display:grid;gap:6px;margin-top:6px}
  .rank-row{display:flex;align-items:center;justify-content:space-between;font-size:12px;border-bottom:1px dashed var(--border);padding:4px 0}
  .rank .bul{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:8px}
  .grid-2{display:grid;grid-template-columns:2fr 1fr;gap:16px}
  .pagination{display:flex;gap:6px;flex-wrap:wrap;margin-top:10px}
  .pagination .btn{padding:6px 10px}
  .hide{display:none}
  #tblTop20 {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
  }
  #tblTop20 th, #tblTop20 td {
    border: 1px solid #e5e7eb;
    padding: 6px 8px;
    text-align: center;
  }
  #tblTop20 th {
    background: #f9fafb;
    font-weight: 600;
  }
  .color-dot {
    display:inline-block;
    width:10px;
    height:10px;
    border-radius:50%;
    margin-right:4px;
  }
  /* === Sidebar: final, deduped === */
.layout-main{display:flex;height:calc(100vh - 48px);}
.sidebar{flex:0 0 230px;background:#f8f8f8;border-right:1px solid #ddd;padding:10px 16px;}
.main-right{flex:1;min-width:0;display:flex;flex-direction:column;}

.sidebar .sidebar-menu,
.sidebar .sidebar-menu ul,
.sidebar .sb-submenu{list-style:none;margin:0;padding-left:0}

/* é¡¶å±‚é¡¹ï¼šé¡¹ç›®åˆ—è¡¨ï¼ˆä¸æŠ˜å ï¼‰ */
.sidebar .sidebar-menu > li:not(.sb-toggle){
  display:flex;align-items:center;gap:8px;
  padding:12px 8px;border-radius:8px;
  color:#003366;font-size:15px;cursor:pointer;
}
.sidebar .sidebar-menu > li:not(.sb-toggle):hover{background:#eef3f8;}
.sidebar .ico{width:16px;text-align:center;font-size:14px;color:#003366;}
.sidebar .sb-txt{color:#003366;font-size:15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.sidebar .caret{margin-left:auto;font-size:12px;color:#8a8a8a;transition:transform .18s;}

/* å¯æŠ˜å é¡¹ï¼šå·¥ä½œç°¿è¯¦æƒ…ï¼ˆçºµå‘å®¹å™¨ï¼‰ */
.sidebar .sb-toggle{display:block;padding:0;}
.sidebar .sb-toggle-head{
  display:flex;align-items:center;gap:8px;
  padding:12px 8px;border-radius:8px;color:#003366;cursor:pointer;
}
.sidebar .sb-toggle-head:hover{background:#eef3f8;}
.sidebar .sb-toggle.open .caret{transform:rotate(90deg);}

/* äºŒçº§èœå•ï¼ˆåµŒå…¥ sb-toggle å†…ï¼‰ */
.sidebar .sb-submenu{display:none;margin:4px 0 8px 16px;}
.sidebar .sb-toggle.open > .sb-submenu{display:block;}

/* äºŒçº§è¡Œï¼šä¸¤åˆ—ç½‘æ ¼ï¼ˆå›¾æ ‡/æ–‡æœ¬ï¼‰ï¼Œæ— å›¾æ ‡é¡¹å ä½ä»¥å¯¹é½ */
.sidebar .sb-submenu .sb-row{
  display:grid;grid-template-columns:18px 1fr;align-items:center;
  column-gap:8px;padding:8px 6px;border-radius:8px;color:#333;font-size:14px;cursor:pointer;
}
.sidebar .sb-submenu .sb-row:hover{background:#eef3f8;color:#2f5ea8;}
.sidebar .sb-submenu .sb-row .sb-txt{color:#333;}
.sidebar .sb-submenu .sb-row:not(.active)::before{content:"";width:18px;height:18px;}

/* é€‰ä¸­ï¼šåªæœ‰â€œé“¶è¡Œæµæ°´åˆ†æâ€æœ‰ç»¿è‰²åœ†åœˆä¸é«˜äº® */
.sidebar .sb-submenu .sb-row.active{background:#e9f2ff;font-weight:600;color:#2f5ea8;}
.sidebar .sb-submenu .sb-row.active .sb-txt{color:#2f5ea8;}
.sidebar .sb-submenu .sb-row.active .ico{color:#32b27c;font-size:15px;}

/* ç½®ç°ç¦ç”¨é¡¹æ ·å¼ */
.sidebar .sb-submenu .sb-row.disabled {
  color: #999 !important;
  background: transparent !important;
  cursor: not-allowed !important;
  opacity: 0.6;
  pointer-events: none;  /* ç¦æ­¢ç‚¹å‡» */
}

.sidebar .sb-submenu .sb-row.disabled .sb-txt {
  color: #999 !important;
}
.main-right { flex:1; display:flex; flex-direction:column; }
.breadcrumb-bar {
  background:#fff;
  border-bottom:1px solid #e6edf5;
  padding:12px 20px;
  font-size:14px;
  color:#334155;
}
.breadcrumb-bar .back-link {
  color:#003366;
  text-decoration:none;
  font-weight:600;
  margin-right:4px;
}
.breadcrumb-bar .sep { margin:0 6px; color:#94a3b8; }
.breadcrumb-bar b { color:#003366; }

.content-scroll { flex:1; overflow:auto; }
.content-wrap { padding:16px 20px 32px; }

/* é¢åŒ…å±‘ */
.breadcrumb-bar{background:#fff;border-bottom:1px solid #e6edf5;padding:12px 20px;font-size:14px;color:#334155}
.breadcrumb-bar .back-link{color:#003366;text-decoration:none;font-weight:600;margin-right:4px}
.breadcrumb-bar .sep{margin:0 6px;color:#94a3b8}
.breadcrumb-bar b{color:#003366}

/* é¡¶éƒ¨æ•´ä½“ï¼šå·¦ KPI + å³ é—®é¢˜åˆ†æ */
.kpi-and-issue{
  display:grid;
  grid-template-columns: minmax(520px, 1fr) 520px;
  gap:10px;
  padding:8px 16px 6px;
}

/* å·¦ä¾§ KPIï¼šä¸¤è¡Œç»“æ„ï¼ˆå‰ä¸‰åˆ—æ›´ç˜¦ï¼Œå³ä¸¤åˆ—æ›´é•¿ï¼‰ */
.kpi-grid{
  display:grid;
  grid-template-columns: 0.8fr 0.8fr 0.8fr 1.2fr 1.2fr;
  grid-template-rows: 64px 64px;
  gap:10px;
  align-items:stretch;
  grid-template-areas:
    "k1 k2 k3 k4 k5"
    "k1 k2 k3 k6 k7";
}

/* KPI åŒºåŸŸæ˜ å°„ */
.k1{ grid-area:k1; } .k2{ grid-area:k2; } .k3{ grid-area:k3; }
.k4{ grid-area:k4; } .k5{ grid-area:k5; } .k6{ grid-area:k6; } .k7{ grid-area:k7; }

/* é€šç”¨ KPI æ ·å¼ */
.kpi{
  background:#f8fafc;
  border:1px solid #e6edf5;
  border-radius:8px;
  padding:6px 10px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:flex-start;
}
.kpi-label{
  font-size:17px;
  color:#334155;
  font-weight:600;
  margin-bottom:3px;
  white-space:nowrap;
}
.kpi-value{
  font-size:17px;
  font-weight:700;
  color:#0f172a;
  line-height:1.1;
  white-space:nowrap;
}
.kpi-value.pos{color:#0f7a43}
.kpi-value.neg{color:#b2162a}
.link-num{ text-decoration:none; border-bottom:1px dotted currentColor }
.link-num:hover{ opacity:.85 }
.link-num.danger{ color:#D2283E }

/* âœ… å‰ä¸‰åˆ—ï¼ˆk1~k3ï¼‰å†…å®¹æ•´ä½“å±…ä¸­ */
.k1, .k2, .k3 {
  display:flex !important;
  flex-direction:column !important;
  justify-content:center !important;
  align-items:center !important;
  text-align:center !important;
}

/* âœ… å³ä¾§ 2Ã—2ï¼ˆk4~k7ï¼‰æ¨ªæ’ï¼Œæ•°å€¼å³å¯¹é½ */
.k4,.k5,.k6,.k7{
  display:flex !important;
  flex-direction:row !important;
  align-items:center !important;
  justify-content:space-between !important;
}
.k4 .kpi-label,.k5 .kpi-label,.k6 .kpi-label,.k7 .kpi-label{margin-bottom:0}
.k4 .kpi-value,.k5 .kpi-value,.k6 .kpi-value,.k7 .kpi-value{
  margin-left:auto; text-align:right;
}

/* âœ… æ•°æ®é—®é¢˜åˆ†æå¡ï¼ˆä¸å·¦ä¾§KPIæ€»é«˜ä¸€è‡´ï¼‰ */
.issue-card{
  background:#fffdf7;
  border:1px solid #ffe6b3;
  border-radius:8px;
  padding:10px 12px;
  height:calc(60px * 2 + 10px);  /* è·Ÿå·¦ä¾§ä¸¤è¡Œæ€»é«˜ä¸€è‡´ï¼ˆ2*è¡Œé«˜ + gapï¼‰ */
  display:flex;
  flex-direction:column;
  justify-content:space-between;
}
.issue-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:6px;
}
.issue-title{color:#8a5c00;font-weight:600}
.issue-link{
  font-size:12px;
  color:#8a5c00;
  text-decoration:none;
  border:1px solid #f5cf85;
  padding:2px 8px;
  border-radius:999px;
  background:#fff7e3;
}
.dot{width:8px;height:8px;border-radius:50%;display:inline-block;margin-right:6px}
.dot-warn{background:#f59e0b;box-shadow:0 0 0 3px rgba(245,158,11,.15)}
.issue-body{color:#8a5c00;font-size:12px;line-height:1.45;flex:1;overflow:auto}
.issue-foot{margin-top:6px}
.mini-link{font-size:12px;color:#8a5c00;text-decoration:underline}

/* ====== æ•°æ®é—®é¢˜å¡æ ¸å¿ƒæ ·å¼ ====== */
.issue-card{
  position: relative;
  background:#fffdf7;
  border:1px solid #ffe6b3;
  border-radius:8px;
  padding:10px 12px 30px;         /* é¢„ç•™åº•éƒ¨ç©ºé—´ç»™å›ºå®šæŒ‰é’® */
  height:calc(60px * 2 + 10px);   /* ä¿æŒä¸å·¦ä¾§ä¸¤è¡ŒKPIç­‰é«˜ */
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  overflow:hidden;                /* é˜²æ­¢å¤–æº¢ */
}

/* é¡¶éƒ¨æ ‡é¢˜æ  */
.issue-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:6px;
}
.issue-title{color:#8a5c00;font-weight:600;font-size:14px;}
.issue-link{
  font-size:12px;
  color:#8a5c00;
  text-decoration:none;
  border:1px solid #f5cf85;
  padding:2px 8px;
  border-radius:999px;
  background:#fff7e3;
}
.issue-link:hover{background:#ffeab5;}

/* å†…å®¹åŒºå¯æ»šåŠ¨ */
.issue-body-simple{
  font-size:12px;
  color:#8a5c00;
  line-height:1.65;
  overflow-y:auto;
  padding-right:8px;
  flex:1;
}

/* ç¬¬ä¸€è¡Œè¯´æ˜ */
.issue-note b{ color:#8a5c00; }

/* ç¬¬äºŒè¡Œï¼šçº¢è‰²è­¦ç¤º + è·³è½¬é“¾æ¥ */
.issue-inline{
  display:flex;
  align-items:center;
  gap:6px;
  margin:0;
  flex-wrap:wrap;
}
.dot-danger{
  width:8px;
  height:8px;
  border-radius:50%;
  background:#dc2626;
  box-shadow:0 0 0 3px rgba(220,38,38,.12);
}
.issue-inline span{
  color:#b2162a;
  font-weight:500;
}
.issue-inline-link{
  color:#b2162a;
  font-weight:600;
  text-decoration:none;
  border-bottom:1px dotted currentColor;
  margin-left:4px;
}
.issue-inline-link:hover{ opacity:.85; }

/* å›ºå®šå³ä¸‹è§’æŒ‰é’® */
.issue-toggle{
  position:absolute;
  right:12px;
  bottom:8px;
  font-size:12px;
  color:#475569;
  text-decoration:underline;
  background:#fffdf7;
  padding:2px 6px;
  border-radius:4px;
  cursor:pointer;
  z-index:2;
}
.issue-toggle:hover{ color:#003366 }

/* å¯é€‰ï¼šç»†æ»šåŠ¨æ¡ï¼ˆç¾åŒ–ï¼‰ */
.issue-body-simple::-webkit-scrollbar{ width:6px; }
.issue-body-simple::-webkit-scrollbar-thumb{
  background:rgba(0,0,0,.15);
  border-radius:4px;
}
.issue-body-simple::-webkit-scrollbar-track{ background:transparent; }

/* ===== Tab å®¹å™¨ï¼šå¼ºåˆ¶æ’‘æ»¡æ•´è¡Œï¼Œä¸ KPI å·¦å¯¹é½ ===== */
.tab-container{
  background:#fff;
  border:1px solid #e6edf5;
  border-radius:8px;
  margin:10px 16px 0;      /* å’Œ .chart-card ä¸€æ ·ç”¨å¤–è¾¹è·å¯¹é½ */
  padding:0;
  box-shadow:0 1px 3px rgba(0,0,0,.04);
  box-sizing:border-box;

  /* â›” åˆ æ‰ calcï¼Œé¿å…å†æ¬¡è¢«çˆ¶å®¹å™¨â€œç¼©ä¸€éâ€ */
  width:auto;              /* è®©çˆ¶å®¹å™¨å†³å®šå®½åº¦ */
  min-width:0;
  max-width:none;

  /* æ— è®ºçˆ¶çº§æ˜¯ grid è¿˜æ˜¯ flexï¼Œéƒ½å¼ºåˆ¶è·¨æ•´è¡Œå¹¶æ‹‰æ»¡ */
  grid-column: 1 / -1;     /* Grid: è·¨å…¨åˆ— */
  justify-self: stretch;   /* Grid: æ‹‰æ»¡ */
  align-self: stretch;     /* Flex/Grid: æ‹‰æ»¡ */
  flex: 1 1 auto;          /* Flex: å¯ä¼¸å±• */
}

/* ===== Tab è¡Œï¼šæ‹‰æ»¡å®¹å™¨ï¼Œç¦ç”¨ä»»ä½• margin ç¼©çŸ­ ===== */
.tab-container .tabbar{
  position:relative;
  display:flex;
  align-items:center;
  flex-wrap:nowrap;
  gap:10px;

  padding:10px 16px 8px;   /* ä¸å¡ç‰‡å†…å®¹ç•™ç™½ä¸€è‡´ */
  margin:0 !important;     /* è¦†ç›–å…¨å±€ `.tabbar{ margin:8px 16px }` çš„å¹²æ‰° */

  border-bottom:1px solid #e6edf5;
  background:#fff;

  width:100%;
  max-width:100%;
  min-width:0;
  overflow-x:auto;
  overflow-y:hidden;
}


/* ===== å•ä¸ª Tabï¼šä»…æ–‡å­—å˜åŒ–ï¼Œä¸é«˜äº®æ•´å—èƒŒæ™¯ ===== */
.tab-container .tab{
  flex:0 0 auto;
  padding:10px 16px;
  cursor:pointer;
  color:#475569;
  border:none;
  background:transparent;
  white-space:nowrap;
  transition:color .15s;
}
.tab-container .tab:hover{ background:transparent; color:#1e40af; }
.tab-container .tab.active{ color:#003366; font-weight:600; background:transparent; }

/* ===== inkbarï¼šåº•éƒ¨è“çº¿ ===== */
.tab-container .inkbar{
  position:absolute;
  bottom:0;
  height:2px;
  background:#003366;   /* ä¸ KPI ä¸»è‰²ä¸€è‡´ */
  border-radius:2px;
  transition:left .25s ease, width .25s ease;
}

/* ===== è¯´æ˜æ¡ï¼ˆä¸å˜ï¼‰ ===== */
.tab-container .tab-intro{
  display:flex;
  align-items:center;
  gap:8px;
  padding:8px 16px 12px 16px;   /* â† ä¸ tabbar åŒæ­¥ä¸º 16px */
  color:#334155;
  font-size:13.5px;
  line-height:2;
  width:100%;
  box-sizing:border-box;
}
.tab-container .ti-icon{ width:14px; height:14px; margin-top:2px; color:#1e40af;flex-shrink:0; }
.tab-container .ti-title{ font-weight:600; margin-right:6px; }

/* ===== å›¾è¡¨å¡ç‰‡å¯¹é½ KPI ===== */
.chart-card{
  background:#fff;
  border:1px solid #e6edf5;
  border-radius:8px;
  padding:16px;
  margin:10px 16px;
  box-shadow:0 1px 3px rgba(0,0,0,0.03);
}

/* ================== ç»è¥å®è´¨æ»šåŠ¨å®¹å™¨ï¼ˆåŠŸèƒ½ + ç¾åŒ–ï¼‰ ================== */
:root{
  --page-gutter: 16px;     /* ä¸ä¸Šæ–¹KPIå·¦å³ç•™ç™½ä¸€è‡´ */
  --tabs-offset: 270px;    /* (è§†å£é«˜åº¦ - è¿™ä¸ªå€¼) = ç™½æ¿å¯è§†é«˜åº¦ï¼Œå¯æŒ‰é¡µé¢å¾®è°ƒ */
}

/* é¡¶éƒ¨ tabs ä¸ KPI å¯¹é½ */
.tabbar{ margin: 8px var(--page-gutter) 0; }

/* â˜… ä¿é™©è¡¥ä¸ï¼šå³ä½¿ tabbar/tab-stage è¢«å†™è¿› .kpi-and-issue çš„ gridï¼Œä¹Ÿå¼ºåˆ¶è·¨æ•´è¡Œ */
.kpi-and-issue .tabbar,
.kpi-and-issue .tab-stage{
  grid-column: 1 / -1 !important;  /* å æ»¡ä¸¤åˆ— */
  width: 100% !important;
  min-width: 0 !important;
  float: none !important;
}

/* ç»Ÿä¸€â€œç™½æ¿èˆå°â€å®¹å™¨ï¼šå›ºå®šé«˜åº¦ï¼Œå†…éƒ¨æ»šåŠ¨ï¼Œä¸¤ä¸ªé¢æ¿å…±ç”¨ */
.tab-stage{
  /* å°ºå¯¸ä¸ä½ç½® */
  margin: 10px var(--page-gutter) 0;
  width: 100%;
  min-width: 0;                 /* â˜… å…³é”®ï¼šåœ¨ flex/grid çˆ¶å®¹å™¨é‡Œé¿å…è¢«æ¨ªå‘å‹ç˜¦ */
  flex: 1 1 auto;               /* â˜… çˆ¶çº§æ˜¯ flex æ—¶å¯æ­£å¸¸ä¼¸å±• */
  position: relative;
  height: calc(100vh - var(--tabs-offset)); /* å›ºå®šç™½æ¿é«˜åº¦ï¼Œå†…éƒ¨æ»šåŠ¨ */
  overflow: hidden;

  /* è§†è§‰ */
  background:#fff;
  border:1px solid #e8edf5;
  border-radius:10px;
  box-shadow:0 2px 10px rgba(17,24,39,.04);

  /* æ€§èƒ½ */
  contain: layout paint;         /* é™ä½é‡ç»˜â€œé¬¼å½±â€æ¦‚ç‡ */
}

/* ä¸¤ä¸ªé¢æ¿é‡å é“ºæ»¡ç™½æ¿ï¼Œåªæ˜¾ç¤º active */
.tab-pane{
  position:absolute; inset:0;
  display:none;
  overflow:hidden;
}
.tab-pane.active{ display:block; }

.tab-pane.hide { display: none !important; }   

/* çœŸæ­£æ»šåŠ¨çš„åŒºåŸŸï¼šæŠŠç­›é€‰/å›¾è¡¨/è¡¨æ ¼éƒ½æ”¾è¿›æ¥ */
.tab-scroll{
  position:absolute; inset:0;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  padding:12px 14px 16px;
}

/* ç™½æ¿é‡Œå¡ç‰‡ï¼šç»Ÿä¸€é£æ ¼ */
.tab-scroll > .card{
  border:1px solid #e9eef6 !important;
  border-radius:10px !important;
  background:#fff !important;
  box-shadow:0 2px 10px rgba(17,24,39,.04) !important;
  margin:12px 0 !important;
  overflow:visible;
}

/* å¡ç‰‡æ ‡é¢˜ï¼šå·¦ä¾§ç»†ç«–æ¡å¼ºè°ƒï¼›ç¦æ­¢ sticky ä»¥å…å å½± */
.tab-scroll .card .head{
  position:static !important;    /* â˜… é˜²æ­¢â€œå¸é¡¶â€å¯¼è‡´çš„å å½± */
  background:#fbfdff;
  border-bottom:1px solid #eef2f7;
  padding:10px 14px;
}
.tab-scroll .card .head .title{
  font-weight:600; color:#0f172a; position:relative; padding-left:10px;
}
.tab-scroll .card .head .title::before{
  content:""; position:absolute; left:0; top:50%; transform:translateY(-50%);
  width:3px; height:16px; border-radius:2px; background:#1e49e2; opacity:.9;
}
.tab-scroll .card .content{ padding:14px 16px 16px; overflow:hidden; }

/* å›¾è¡¨ç»Ÿä¸€é«˜åº¦ï¼ˆå¯æŒ‰éœ€è°ƒï¼‰ */
.tab-scroll .chart{ height:260px; max-height:38vh; min-height:220px; }

/* è¡¨æ ¼ç»†åŒ– */
.tab-scroll .table{ width:100%; border-collapse:collapse; font-size:13px; }
.tab-scroll .table th,.tab-scroll .table td{
  border:1px solid #eef2f7; padding:8px 10px; text-align:center; white-space:nowrap;
}
.tab-scroll .table th{ background:#f7faff; color:#334155; font-weight:600; }
.tab-scroll .table tr:hover td{ background:#f8fbff; }

/* æ»šåŠ¨æ¡ç¾åŒ–ï¼ˆå¯é€‰ï¼‰ */
.tab-scroll::-webkit-scrollbar{ width:6px }
.tab-scroll::-webkit-scrollbar-thumb{ background:rgba(15,23,42,.18); border-radius:4px }
.tab-scroll::-webkit-scrollbar-track{ background:transparent }

/* ä¿é™©ï¼šå¤–å±‚å¯ä¼¸å±•å®¹å™¨å–æ¶ˆæœ€å°å®½åº¦é™åˆ¶ï¼Œé¿å…è¢«å‹ç˜¦æˆå³ä¾§ç»†ç¼ */
.main-right, .content-scroll, .content-wrap, .tabbar{ min-width: 0; }

/* Routine å³ä¾§çš„åŒåˆ—å¸ƒå±€é—´è· */
.grid-2{ display:grid; grid-template-columns: 2fr 1.2fr; gap: 16px; }

/* çª„å±æ—¶æŠŠ offset è°ƒå°ä¸€äº›ï¼Œé¿å…ç™½æ¿è¿‡çŸ® */
@media (max-width: 1366px){
  :root{ --tabs-offset: 300px; }
}

/* å“åº”å¼ï¼šçª„å±å †å ï¼ˆä¿ç•™åŸé€»è¾‘ï¼‰ */
@media (max-width:1200px){
  .kpi-and-issue{ grid-template-columns: 1fr; }
  .issue-card{ order:2 }
}

/* ===== ç­›é€‰åŒºï¼šlabel æ™®é€šï¼Œç­›é€‰æ¡†æ‰æ˜¯èƒ¶å›Š ===== */
/* ===== ç­›é€‰åŒºï¼šlabel æ™®é€šï¼Œç­›é€‰æ¡†æ‰æ˜¯èƒ¶å›Š ===== */
.filter-card {
  background: #fff;
  border: 1px solid #e6edf5;
  border-radius: 10px;
  padding: 18px 24px;
  margin: 10px 16px 12px;
  max-width: calc(100% - 32px);
  box-shadow: 0 2px 8px rgba(17,24,39,0.05);
}
.filter-area {
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  justify-content:flex-start;
  gap:12px 16px;
  padding:10px 0 14px;
}
.filter-area label {
  font-size:14px; color:#334155; font-weight:600;
  line-height:36px; margin-right:6px;
}
/* èƒ¶å›Šè¾“å…¥/ä¸‹æ‹‰ */
.filter-area select,
.filter-area input[type="text"],
.filter-area input[type="date"] {
  font-size:14px; height:36px; line-height:36px;
  padding:0 14px; min-width:160px;
  border:1px solid #cfd9e5; border-radius:50px;
  background:#fff; box-shadow:0 1px 2px rgba(0,0,0,0.04);
  transition:all .2s ease;
}
.filter-area select:hover,
.filter-area input[type="text"]:hover,
.filter-area input[type="date"]:hover {
  border-color:#1e49e2; box-shadow:0 0 0 3px rgba(30,73,226,0.08);
}
.filter-area select:focus,
.filter-area input[type="text"]:focus,
.filter-area input[type="date"]:focus {
  outline:none; border-color:#0d3bc4; box-shadow:0 0 0 3px rgba(13,59,196,0.12);
}
.filter-area .range-sep {
  margin:0 6px; color:#64748b; font-size:13px; line-height:36px; user-select:none;
}
.filter-area button {
  height:36px; font-size:14px; padding:0 18px; border-radius:50px;
  border:none; cursor:pointer; transition:0.2s;
}
.filter-area .query { background:#1e49e2; color:#fff; }
.filter-area .query:hover { background:#0d3bc4; }
.filter-area .reset { background:#eef3fb; color:#334155; }
.filter-area .reset:hover { background:#e6eefc; color:#1e293b; }
@media (max-width:1200px){
  .filter-area{ justify-content:center; gap:10px 12px; }
  .filter-area select,.filter-area input{ min-width:130px; }
}

/* â€”â€” ä¸‹æ‹‰å°ç®­å¤´ï¼ˆç¾è§‚ï¼‰ â€”â€” */
.select-wrap{ position:relative; display:inline-block; }
.select-wrap select{
  appearance:none; -webkit-appearance:none; -moz-appearance:none;
  padding-right:36px; background:#fff;
}
.select-wrap .chev{
  position:absolute; right:12px; top:50%; transform:translateY(-50%);
  width:18px; height:18px; pointer-events:none; opacity:.75;
}
.select-wrap .chev svg{ width:100%; height:100%; display:block; }

/* â€”â€” â€œä¸åŒ…å«â€ åœ†åœˆæŒ‰é’® â€”â€” */
.negate{
  display:inline-flex; align-items:center; gap:6px; margin-left:8px;
  font-size:13px; color:#5b6b7e; user-select:none;
}
.negate input{
  appearance:none; width:14px; height:14px; border:2px solid #7788a0;
  border-radius:50%; position:relative; cursor:pointer; outline:0;
}
.negate input:checked{ border-color:#1e49e2; }
.negate input:checked::after{ content:""; position:absolute; inset:2px; border-radius:50%; background:#1e49e2; }

/* ====== ç»è¥å®è´¨é¢æ¿ï¼ˆå·¦ä¾§è“æ¡ + å¤´éƒ¨æ·¡è“æ¡ï¼‰ ====== */
#pane-biz .panel{
  position:relative;
  background:#fff;
  border:1px solid #e6edf5;
  border-radius:10px;
  margin:12px 16px;
  padding:12px 16px 16px 28px; /* å·¦ä¾§ç•™ç©ºé—´ */
  box-shadow:0 2px 8px rgba(17,24,39,.04);
}
#pane-biz .panel::before{
  content:"";
  position:absolute;
  left:10px; top:12px; bottom:12px;
  width:4px; border-radius:4px;
  background:#1e49e2;
}

/* é¢æ¿å¤´éƒ¨ */
#pane-biz .panel-head{
  display:flex; align-items:center; justify-content:space-between;
  background:#f8fbff;
  border:1px solid #e8f0ff;
  border-radius:8px;
  padding:8px 12px;
  margin:-4px 0 10px;
}
.ph-left{ display:flex; align-items:center; gap:10px; }
.ph-title{ font-size:15px; font-weight:700; color:#0f172a; }

/* å³ä¾§æŒ‰é’® */
.btn-ghost{
  height:26px; padding:0 10px; border:1px solid #d8e1ee; border-radius:14px;
  background:#fff; color:#334155; font-size:12px; cursor:pointer;
}
.btn-ghost:hover{ background:#eef3ff; border-color:#c7d4f4; }
.ph-right{ display:flex; align-items:center; gap:10px; }
.note-link{ display:inline-flex; align-items:center; gap:6px; color:#1e49e2; cursor:pointer; }
.note-link .icon{ width:14px; height:14px; }
.note-link u{ text-underline-offset:3px; }

/* æ ‡é¢˜å³ä¾§èƒ¶å›Šä¸‹æ‹‰ */
.pill-wrap{ position:relative; display:inline-block; }
.pill-select{
  appearance:none; -webkit-appearance:none; -moz-appearance:none;
  height:30px; line-height:30px;
  border-radius:20px; border:1px solid #cfd9e5;
  padding:0 30px 0 12px; font-size:13px; background:#fff; cursor:pointer;
}
.pill-wrap .chev{
  position:absolute; right:10px; top:50%; transform:translateY(-50%);
  width:16px; height:16px; pointer-events:none; color:#64748b;
}

/* KPI ç»Ÿä¸€ */
#pane-biz .kpi-row{
  display:grid; grid-template-columns:repeat(4,1fr);
  gap:10px; margin:8px 0 4px;
}
#pane-biz .kpi{
  background:#f8fafc; border:1px solid #eef2f7;
  border-radius:10px; padding:10px 12px;
}
#pane-biz .kpi .k{ font-size:12px; color:#64748b; margin-bottom:2px; }
#pane-biz .kpi .v{ font-weight:700; color:#0f172a; }

/* å›¾è¡¨é«˜åº¦ */
#pane-biz .chart-lg{ height:300px; }
#pane-biz .chart-md{ height:260px; }

/* ===== æ„æˆåŒºåŸŸæ ·å¼ï¼ˆä¸ä½ ç°æœ‰é£æ ¼ä¸€è‡´ï¼‰ ===== */
.tabs-mini{display:inline-flex;gap:6px;background:#f8fafc;border:1px solid #e6edf5;border-radius:20px;padding:3px;margin:6px 0 10px}
.tabs-mini .tab{padding:6px 12px;border-radius:14px;font-size:12px;cursor:pointer;color:#334155;user-select:none}
.tabs-mini .tab.active{background:#eef3ff;color:#2152ff;border:1px solid #d6e4ff}

.seven-cats{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;margin:6px 0 2px}
.seven-cats .cat{background:#f8fafc;border:1px solid #e6edf5;border-radius:10px;padding:10px 8px;text-align:center}
.seven-cats .name{font-size:12px;color:#475569;margin-bottom:6px}
.seven-cats .pct{font-weight:700;color:#0f172a}

.grid-2{display:grid;grid-template-columns:1.2fr .95fr;gap:14px;margin-top:10px}
.chart-md{width:100%;height:320px;min-height:300px;background:#fff;border:1px solid #e6edf5;border-radius:10px;padding:8px}

/* â€”â€” Top20 åˆ—è¡¨å¡ â€”â€” */
/* ===== Top20ï¼šæ ‡é¢˜åœ¨ä¸Š + å³ä¾§æ€»é¢ï¼Œåˆ—è¡¨è‡ªé€‚åº”å‰©ä½™é«˜åº¦ï¼ˆæ— éœ€æ”¹JSï¼‰ ===== */
.top20-card{
  background:#fff;
  border:1px solid #e6edf5;
  border-radius:10px;
  padding:10px 12px;

  /* å…³é”®ï¼šæ”¹ä¸ºå¼¹æ€§å¸ƒå±€å¹¶å æ»¡å®¹å™¨é«˜åº¦ */
  display:flex;
  flex-direction:column;
  height:100%;
  overflow:hidden;   /* é˜²æ­¢é˜´å½±/å†…å®¹æº¢å‡º */
  min-height:0;     /* å…³é”®ï¼šå…è®¸åœ¨çˆ¶å®¹å™¨ä¸­è¢«å‹ç¼© */
}

/* å¤´éƒ¨ï¼šå·¦æ ‡é¢˜ + å³æ€»é¢ */
.top20-head{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  margin-bottom:8px;
  flex:0 0 auto;    /* å›ºå®šé«˜åº¦åŒºåŸŸ */
}
.top20-title{ font-size:14px; font-weight:800; color:#0f172a; }
.top20-total{ font-weight:800; color:#2152ff; font-variant-numeric:tabular-nums; }
.top20-sub{ font-size:12px; color:#64748b; margin-left:8px; }

/* åˆ—è¡¨åŒºåŸŸï¼šå æ»¡å‰©ä½™ç©ºé—´ + å¯æ»šåŠ¨ï¼ˆæ ¸å¿ƒæ”¹åŠ¨ï¼‰ */
.top20-list{
  flex:1 1 auto;    /* åƒæ‰å‰©ä½™é«˜åº¦ */
  min-height:0;     /* å…³é”®ï¼šä¸å†™è¿™å¥ä¼šæŠŠçˆ¶å®¹å™¨æ’‘ç ´å¯¼è‡´â€œæ¡†å¤–â€ */
  overflow:auto;
  padding-right:4px;
}

/* è¡Œï¼šæ’è¡Œ + åç§° + é‡‘é¢ */
.top20-row{
  display:grid;
  grid-template-columns:26px 1fr 120px;
  align-items:center;
  padding:6px 0;
  border-bottom:1px dashed #eef2f7;
}
.top20-row:last-child{ border-bottom:none; }

/* æ’åå¾½ç« ï¼šå‰ä¸‰ï¼ˆé‡‘/é“¶/é“œï¼‰ï¼Œå…¶ä½™è“æè¾¹ */
.rank-badge{
  width:22px; height:22px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:12px; font-weight:700;
  color:#2152ff; background:#eef3ff; border:1px solid #d6e4ff;
}
.rank-badge.top1{ background:#fddc7a; color:#7a5900; border-color:#f4cc50; } /* é‡‘ */
.rank-badge.top2{ background:#e8edf5; color:#364152; border-color:#cfd8e3; } /* é“¶ */
.rank-badge.top3{ background:#f4e1cf; color:#6b3f23; border-color:#edc8a9; } /* é“œ */

.cp-name{
  color:#0f172a; font-size:13px;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.cp-amt{
  text-align:right; color:#0f172a; font-weight:700;
  font-variant-numeric:tabular-nums;
}

/* æ»šåŠ¨æ¡ç¾åŒ– */
.top20-list::-webkit-scrollbar{ width:6px }
.top20-list::-webkit-scrollbar-thumb{ background:#e6edf5; border-radius:99px }
.top20-list::-webkit-scrollbar-thumb:hover{ background:#d5dfef }

/* â€”â€” è¡¨æ ¼ä¸Šæ–¹æç¤ºè¡Œ â€”â€” */
.table-announce{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding:6px 2px 8px; margin:8px 0 6px;
  font-size:13px; line-height:1.7; color:#334155;
  /* è·Ÿå¡ç‰‡/è¡¨æ ¼å¯¹é½ï¼šå®¹å™¨å®½åº¦ç”±çˆ¶çº§å†³å®š */
  width:100%; box-sizing:border-box;
}
.table-announce .left-msg{ flex:1 1 auto; min-width:0; }
.table-announce .right-msg{ flex:0 0 auto; white-space:nowrap; color:#64748b; }

/* æ–‡ä»¶åé«˜äº®ï¼ˆè“è‰²ï¼‰ */
.table-announce .file-link{
  color:#2152ff; text-decoration:underline; cursor:pointer;
}
.table-announce .file-link:hover{ text-decoration:none; }

/* å°å±æ—¶è‡ªåŠ¨æ¢è¡Œï¼Œå³ä¾§æç¤ºä¸‹ç§»é å³ */
@media (max-width: 1200px){
  .table-announce{ flex-direction:column; align-items:flex-start; }
  .table-announce .right-msg{ align-self:flex-end; }
}


/* å“åº”å¼ï¼šçª„å±æŠŠæ€»é¢å¡å †åˆ°ä¸Šé¢ */
@media (max-width: 1280px){
  .top20-panel{ grid-template-columns: 1fr }
  .top20-left{ height: 96px }
  .top20-list{ max-height: 212px }
}
    
/* è®© ECharts å®¹å™¨æ›´é«˜çº§ä¸€äº›ï¼ˆåœ†è§’+é˜´å½±ä¸é¢æ¿ç»Ÿä¸€ï¼‰ */
.chart-lg, .chart-md {
  border-radius: 10px;
  background: #fff;
  box-shadow: 0 2px 8px rgba(17,24,39,.04) inset;
}
/* tooltip å¡ç‰‡ */
.tip-card{
  padding:8px 10px;border:1px solid #e6edf5;border-radius:8px;background:#fff;
  box-shadow:0 6px 24px rgba(15,23,42,.08);font-size:12px;color:#0f172a
}
.tip-card .t{font-weight:700;margin-bottom:6px;color:#334155}
.tip-row{display:flex;justify-content:space-between;gap:16px;line-height:18px}
.tip-k{color:#64748b}
.tip-v{font-variant-numeric:tabular-nums}

/* çª„å±é€‚é… */
@media (max-width:1200px){
  .filter-area{
    justify-content:center;
    gap:10px 12px;
  }
  .filter-area select,
  .filter-area input{
    min-width:130px;
  }
}

/* å·¥å…·æ è¡Œï¼šå·¦å³åˆ†å¸ƒï¼Œè‡ªåŠ¨æ¢è¡Œ */
.table-toolbar{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; margin:10px 0 8px;
}

/* ä¸¤æ®µå¼åˆ‡æ¢ï¼ˆSegmented Controlï¼‰ */
.seg{
  display:inline-flex; gap:0; background:#f8fafc;
  border:1px solid #e6edf5; border-radius:22px; padding:3px;
}
.seg .opt{
  min-width:86px; padding:6px 14px; border:0; cursor:pointer;
  background:transparent; color:#334155; font-size:13px; border-radius:16px;
  transition:all .18s ease; outline:none;
}
.seg .opt:hover{ color:#1e40af; }
.seg .opt.active{
  background:#eef3ff; color:#2152ff; border:1px solid #d6e4ff;
}

/* å³ä¾§æŒ‰é’®ç»„ï¼ˆä¸ä½ ç°æœ‰é£æ ¼åè°ƒï¼‰ */
.btn-bar{ display:flex; gap:8px; flex-wrap:wrap; }
.btn{
  padding:6px 12px; border-radius:8px; font-size:13px; line-height:1;
  border:1px solid #e6edf5; background:#fff; color:#0f172a; cursor:pointer;
  transition:all .15s ease;
}
.btn:hover{ background:#f6f9ff; border-color:#d6e4ff; }
.btn.ghost{ color:#2152ff; border-color:#d6e4ff; background:#fff; }
.btn.ghost:hover{ background:#eef3ff; }
.btn.primary{ color:#fff; background:#2152ff; border-color:#2152ff; }
.btn.primary:hover{ filter:brightness(.96); }

/* æ”¶çª„å±å¤„ç†ï¼šæŒ‰é’®æ¢è¡Œï¼Œåˆ‡æ¢å§‹ç»ˆåœ¨æœ€å·¦ */
@media (max-width: 1200px){
  .table-toolbar{ flex-direction:column; align-items:stretch; }
  .btn-bar{ justify-content:flex-end; }
}

/* å›¾ä¾‹ */
.legend{display:flex;gap:14px;justify-content:flex-end;margin:6px 0 10px}
.legend i{width:10px;height:10px;border-radius:2px;display:inline-block;margin-right:6px}
.lg-warn{background:#facc15}.lg-none{background:#cbd5e1}.lg-ok{background:#3b82f6}.lg-err{background:#ef4444}

/* æ§åˆ¶å‚æ•° */
.check-scope{--dot:12px;--col:22px;--gap:4px;--sepw:20px;--year:#334155}

/* è¡¨å¤´ä¸ç®­å¤´ */
.check-head{display:flex;align-items:center;gap:8px;color:#475569;font-size:13px;user-select:none;white-space:nowrap}
.check-head .y{color:var(--year);font-weight:600}
.arrow-btn{display:inline-flex;align-items:center;justify-content:center;width:26px;height:24px;border:1px solid #cbd5e1;background:#fff;border-radius:6px;cursor:pointer;transition:.25s}
.arrow-btn:hover{background:#f1f5f9}
.arrow-btn svg{width:14px;height:14px;fill:#334155;transition:transform .25s}
.arrow-btn.expanded svg{transform:rotate(90deg)}

/* æœˆä»½ç½‘æ ¼ */
.months-grid{
  display:inline-grid;
  align-items:center;justify-content:flex-start;
  column-gap:var(--gap);
  grid-template-columns:[y24] repeat(12,var(--col));
  width:max-content;white-space:nowrap;
}
.check-scope.expanded .months-grid{
  grid-template-columns:[y23] repeat(12,var(--col)) [sep] var(--sepw) [y24] repeat(12,var(--col));
}

/* å¹´ä»½æ ‡ç­¾ç½‘æ ¼ */
.y-labels{
  display:inline-grid;align-items:center;column-gap:var(--gap);
  grid-template-columns:[y24] repeat(12,var(--col));
  width:max-content;
}
.check-scope.expanded .y-labels{
  grid-template-columns:[y23] repeat(12,var(--col)) [sep] var(--sepw) [y24] repeat(12,var(--col));
}
.y-2023{grid-column:y23}
.y-2024{grid-column:y24}
.sep-label{grid-column:sep;text-align:center;color:#94a3b8}

/* æ”¶èµ·é»˜è®¤éšè—2023åˆ— */
.y-2023,.sep-label,.col-2023,.col-sep{display:none!important}
.check-scope.expanded .y-2023,
.check-scope.expanded .sep-label,
.check-scope.expanded .col-2023,
.check-scope.expanded .col-sep{display:inline-block!important}

/* æœˆä»½æ•°å­—ï¼ˆåˆè®¡è¡Œï¼‰ */
.month-num{font-size:12px;color:#64748b;text-align:center;line-height:1}

/* æ•°æ®ç‚¹ */
.months-grid .chk-dot{display:inline-block;width:var(--dot);height:var(--dot);border-radius:3px;vertical-align:middle}
.months-grid .chk-ok{background:#3b82f6}
.months-grid .chk-none{background:#cbd5e1}
.months-grid .chk-warn{background:#facc15}
.months-grid .chk-err{background:#ef4444}

/* è¡¨æ ¼åˆ—å®½ä¼˜åŒ– */
.table{table-layout:auto}
.table th.check-col,.table td.check-col{width:1%;white-space:nowrap}
.table td .check-row{padding:6px 0}

/* ===== è¡¨å¤´é¢œè‰²å®šä¹‰ ===== */
.table thead th {
  background: #F6F8FE;   /* è¿™æ˜¯ä½ æˆªå›¾ä¸­è¡¨å¤´çš„æµ…è“ç°è‰²ï¼Œå¯æ¢å…¶ä»–è‰² */
  color: #0f172a;         /* å­—ä½“é¢œè‰² */
  font-weight: 600;
}

/* ===== åˆè®¡è¡Œä¸è¡¨å¤´åŒè‰² ===== */
.table tr.sum-row td {
  background: #F6F8FE;
  color: #0f172a;
  font-weight: 600;
}

/* ç¼ºå¤±åŒåè´¦æˆ·å¯å±•å¼€æŒ‰é’®æ ·å¼ */
.expand-btn{
  border:none;
  background:none;
  cursor:pointer;
  font-size:14px;
  margin-right:4px;
  color:#334155;
  transition:.2s;
}
.expand-btn:hover{color:#1e3a8a}

/* è¡Œæ ·å¼ */
.group-row td{
  font-weight:600;
  background:#F6F8FE;  /* æµ…ç°åº•ï¼ŒåŒºåˆ†å±‚çº§ */
}
.detail-row{
  background:#ffffff;   /* æ˜ç»†è¡Œç™½åº• */
}
.text-muted{
  color:#94a3b8;
  font-size:12px;
}

/* ===== æ“ä½œåˆ—å›¾æ ‡æ ·å¼ ===== */
.actions a {
  display: inline-block;
  margin: 0 6px;
  font-size: 16px;
  color: #2563eb;          /* è“è‰²ï¼Œä¸æŒ‰é’®ä¸€è‡´ */
  text-decoration: none;
  transition: 0.2s ease;
}
.actions a:hover {
  color: #1e3a8a;          /* æ·±è“ hover æ•ˆæœ */
  transform: scale(1.1);
}

/* å¯é€‰ï¼šè®©æ“ä½œåˆ—å›ºå®šå®½åº¦ï¼Œå›¾æ ‡å±…ä¸­ */
.actions {
  text-align: center;
  min-width: 70px;
}

#btnAccountLogic::before {
  content: "ğŸ’¡";           /* ç¯æ³¡å›¾æ ‡ */
  margin-right: 6px;
  font-size: 15px;
  vertical-align: middle;
}

#btnAccountTips::before {
  content: "â­";           /* æ˜Ÿæ˜Ÿå›¾æ ‡ */
  margin-right: 6px;
  font-size: 15px;
  vertical-align: middle;
}
/* æŒ‰é’®å†…å®¹æ•´ä½“å¯¹é½å¾®è°ƒï¼ˆå¯é€‰ï¼‰ */
.head-inline .btn {
  display: inline-flex;
  align-items: center;     /* âœ… å›¾æ ‡ä¸æ–‡å­—å‚ç›´å±…ä¸­ */
  justify-content: center;
  gap: 4px;                /* å›¾æ ‡å’Œæ–‡å­—ä¹‹é—´çš„é—´è· */
}

/* ========== è¡¨å¤´åŒç®­å¤´ç¾åŒ–ï¼ˆç´§å‡‘å¯¹é½ç‰ˆï¼‰ ========== */

/* ==================== è¡¨å¤´åŒç®­å¤´æ ·å¼ ==================== */
#tblAccountSummary thead th.sortable:not(.check-col) {
  position: relative;
  padding-right: 20px;         /* ç®­å¤´é¢„ç•™ç©ºé—´ */
  cursor: pointer;
  color: #334155;
  font-weight: 500;
  user-select: none;
  white-space: nowrap;
}

/* é»˜è®¤çŠ¶æ€ï¼šä¸Šä¸‹ç°ç®­å¤´ */
#tblAccountSummary thead th.sortable:not(.check-col)::before,
#tblAccountSummary thead th.sortable:not(.check-col)::after {
  content: "";
  position: absolute;
  right: 6px;
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  opacity: 0.6;
  transition: all 0.2s ease;
}

/* ä¸Šç®­å¤´ï¼ˆæœä¸Šï¼‰ */
#tblAccountSummary thead th.sortable:not(.check-col)::before {
  top: calc(50% - 6px);
  border-bottom: 6px solid #cbd5e1;
}

/* ä¸‹ç®­å¤´ï¼ˆæœä¸‹ï¼‰ */
#tblAccountSummary thead th.sortable:not(.check-col)::after {
  top: calc(50% + 3px);
  border-top: 6px solid #cbd5e1;
}

/* æ‚¬åœæ—¶æ•´ä½“å˜äº® */
#tblAccountSummary thead th.sortable:not(.check-col):hover::before,
#tblAccountSummary thead th.sortable:not(.check-col):hover::after {
  border-bottom-color: #94a3b8;
  border-top-color: #94a3b8;
  opacity: 0.9;
}

/* å‡åºï¼šä¸Šç®­å¤´è“ï¼Œä¸‹ç®­å¤´ç° */
#tblAccountSummary thead th.sortable.sort-asc:not(.check-col)::before {
  border-bottom-color: #1e40af;
  opacity: 1;
}
#tblAccountSummary thead th.sortable.sort-asc:not(.check-col)::after {
  border-top-color: #cbd5e1;
  opacity: 0.5;
}

/* é™åºï¼šä¸‹ç®­å¤´è“ï¼Œä¸Šç®­å¤´ç° */
#tblAccountSummary thead th.sortable.sort-desc:not(.check-col)::after {
  border-top-color: #1e40af;
  opacity: 1;
}
#tblAccountSummary thead th.sortable.sort-desc:not(.check-col)::before {
  border-bottom-color: #cbd5e1;
  opacity: 0.5;
}

/* æ˜ç¡®ä¸æ˜¾ç¤ºç®­å¤´çš„åˆ— */
#tblAccountSummary thead th.nosort::before,
#tblAccountSummary thead th.nosort::after {
  content: none !important;
}

/* ==================== è¡¨å¤´åŒç®­å¤´æ ·å¼ ==================== */
#tblMissingSameName thead th.sortable:not(.check-col) {
  position: relative;
  padding-right: 20px;
  cursor: pointer;
  color: #334155;
  font-weight: 500;
  user-select: none;
  white-space: nowrap;
}

/* é»˜è®¤çŠ¶æ€ï¼šä¸Šä¸‹ç°ç®­å¤´ */
#tblMissingSameName thead th.sortable:not(.check-col)::before,
#tblMissingSameName thead th.sortable:not(.check-col)::after {
  content: "";
  position: absolute;
  right: 6px;
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  opacity: 0.6;
  transition: all 0.2s ease;
}

/* ä¸Šç®­å¤´ï¼ˆæœä¸Šï¼‰ */
#tblMissingSameName thead th.sortable:not(.check-col)::before {
  top: calc(50% - 6px);
  border-bottom: 6px solid #cbd5e1;
}

/* ä¸‹ç®­å¤´ï¼ˆæœä¸‹ï¼‰ */
#tblMissingSameName thead th.sortable:not(.check-col)::after {
  top: calc(50% + 3px);
  border-top: 6px solid #cbd5e1;
}

/* æ‚¬åœäº®ä¸€ç‚¹ */
#tblMissingSameName thead th.sortable:not(.check-col):hover::before,
#tblMissingSameName thead th.sortable:not(.check-col):hover::after {
  border-bottom-color: #94a3b8;
  border-top-color: #94a3b8;
  opacity: 0.9;
}

/* âœ… å‡åºçŠ¶æ€ */
#tblMissingSameName thead th.sortable.sort-asc:not(.check-col)::before {
  border-bottom-color: #1e40af;
  opacity: 1;
}
#tblMissingSameName thead th.sortable.sort-asc:not(.check-col)::after {
  border-top-color: #cbd5e1;
  opacity: 0.4;
}

/* âœ… é™åºçŠ¶æ€ */
#tblMissingSameName thead th.sortable.sort-desc:not(.check-col)::after {
  border-top-color: #1e40af;
  opacity: 1;
}
#tblMissingSameName thead th.sortable.sort-desc:not(.check-col)::before {
  border-bottom-color: #cbd5e1;
  opacity: 0.4;
}

/* ä¸æ’åºçš„åˆ— */
#tblMissingSameName thead th.nosort::before,
#tblMissingSameName thead th.nosort::after {
  content: none !important;
}

    /* ====== å·²çŸ¥å…³è”æ–¹é¢æ¿ï¼ˆå·¦ä¾§è“æ¡ + å¤´éƒ¨æ·¡è“æ¡ï¼‰ ====== */
#pane-relation .panel{
  position:relative;
  background:#fff;
  border:1px solid #e6edf5;
  border-radius:10px;
  margin:12px 16px;
  padding:12px 16px 16px 28px; /* å·¦ä¾§ç•™ç©ºé—´ */
  box-shadow:0 2px 8px rgba(17,24,39,.04);
}
#pane-relation .panel::before{
  content:"";
  position:absolute;
  left:10px; top:12px; bottom:12px;
  width:4px; border-radius:4px;
  background:#1e49e2;
}

/* é¢æ¿å¤´éƒ¨ */
#pane-relation .panel-head{
  display:flex; align-items:center; justify-content:space-between;
  background:#f8fbff;
  border:1px solid #e8f0ff;
  border-radius:8px;
  padding:8px 12px;
  margin:-4px 0 10px;
}
.ph-left{ display:flex; align-items:center; gap:10px; }
.ph-title{ font-size:15px; font-weight:700; color:#0f172a; }

/* KPI ç»Ÿä¸€ */
#pane-relation .kpi-row{
  display:grid; grid-template-columns:repeat(4,1fr);
  gap:10px; margin:8px 0 4px;
}
#pane-relation .kpi{
  background:#f8fafc; border:1px solid #eef2f7;
  border-radius:10px; padding:10px 12px;
}
#pane-relation .kpi .k{ font-size:12px; color:#64748b; margin-bottom:2px; }
#pane-relation .kpi .v{ font-weight:700; color:#0f172a; }

/* å›¾è¡¨é«˜åº¦ */
#pane-relation .chart-lg{ height:300px; }
#pane-relation .chart-md{ height:260px; }
    
</style>
</head>

<body>
  <!-- ====== å¹³å° Header ====== -->
  <header class="layout-header">
    <div _ngcontent-ng-c2218024402="" class="header-menu-control" style="position: relative;"><svg _ngcontent-ng-c2218024402="" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: var(--responsive-size-16); height: var(--responsive-size-16);"><path _ngcontent-ng-c2218024402="" fill-rule="evenodd" clip-rule="evenodd" d="M1.40003 2.79995C1.40003 2.46858 1.66866 2.19995 2.00003 2.19995L14.8 2.19995C15.1314 2.19995 15.4 2.46858 15.4 2.79995C15.4 3.13132 15.1314 3.39995 14.8 3.39995L2.00003 3.39995C1.66866 3.39995 1.40003 3.13132 1.40003 2.79995ZM15.0909 5.47515C15.2816 5.58088 15.4 5.7818 15.4 5.9999L15.4003 9.9999C15.4004 10.218 15.282 10.419 15.0912 10.5247C14.9005 10.6305 14.6673 10.6244 14.4824 10.5088L11.2821 8.50876C11.1066 8.39913 11 8.20684 11 7.99996C11 7.79309 11.1066 7.6008 11.282 7.49115L14.482 5.49115C14.667 5.37556 14.9001 5.36943 15.0909 5.47515ZM12.7321 7.99993L14.2003 8.91741L14.2001 7.08245L12.7321 7.99993ZM1.40003 6.26662C1.40003 5.93524 1.66865 5.66662 2.00002 5.66662L8.40003 5.66662C8.7314 5.66662 9.00003 5.93525 9.00003 6.26662C9.00003 6.59799 8.7314 6.86662 8.40003 6.86662L2.00002 6.86662C1.66865 6.86662 1.40002 6.59799 1.40003 6.26662ZM1.40002 9.73328C1.40002 9.40191 1.66865 9.13328 2.00002 9.13328H8.40003C8.7314 9.13328 9.00003 9.40191 9.00003 9.73328C9.00003 10.0647 8.7314 10.3333 8.40003 10.3333H2.00002C1.66865 10.3333 1.40002 10.0647 1.40002 9.73328ZM1.40002 13.1999C1.40002 12.8686 1.66865 12.5999 2.00002 12.5999L14.8 12.6C15.1314 12.6 15.4 12.8686 15.4 13.2C15.4 13.5313 15.1314 13.8 14.8 13.8L2.00002 13.7999C1.66865 13.7999 1.40002 13.5313 1.40002 13.1999Z" fill="white"></path></svg><!----><!----></div>
    <div _ngcontent-ng-c2218024402="" class="layout-header-name">KPMG Audit Compass <span _ngcontent-ng-c2218024402="" class="layout-header-project ng-star-inserted">Test2 20251022</span><!----></div>
    <nav class="layout-header-nav">
      <span>ä¸­/EN</span>
      <span>Eric</span>
      <span>è®¾ç½®</span>
    </nav>
  </header>

  <!-- ====== ä¸»ä½“åŒºåŸŸï¼šå·¦ä¾§å¹³å°ä¾§æ  + å³ä¾§å†…å®¹æ»šåŠ¨å®¹å™¨ ====== -->
<div class="layout-main">
  <!-- å·¦ä¾§ -->
  <aside class="sidebar">
    <ul class="sidebar-menu">
      <!-- é¡¶å±‚ï¼šé¡¹ç›®åˆ—è¡¨ -->
      <li>
        <i class="fa-solid fa-bars ico"></i>
        <span class="sb-txt">é¡¹ç›®åˆ—è¡¨</span>
      </li>
  
      <!-- é¡¶å±‚ï¼šå·¥ä½œç°¿è¯¦æƒ…ï¼ˆä¸‹æ‹‰ï¼‰ -->
      <li class="sb-toggle">
        <div class="sb-toggle-head" onclick="toggleSb(this.parentElement)">
          <i class="fa-solid fa-folder ico"></i>
          <span class="sb-txt">å·¥ä½œç°¿è¯¦æƒ…</span>
          <i class="fa-solid fa-angle-right caret"></i>
        </div>
  
        <!-- äºŒçº§èœå•ï¼šåªæœ‰â€œé“¶è¡Œæµæ°´åˆ†æâ€æœ‰ç»¿è‰²åœ†åœˆ -->
        <ul class="sb-submenu">
          <li class="sb-row active">
            <i class="fa-regular fa-circle-check ico"></i>
            <span class="sb-txt">æ•°æ®ä¸Šä¼ </span>
          </li>
          <li class="sb-row active">
            <i class="fa-regular fa-circle-check ico"></i>
            <span class="sb-txt">é“¶è¡Œæµæ°´åˆ†æ</span>
          </li>
          <li class="sb-row disabled"><span class="sb-txt">å¢å€¼ç¨æ•°æ®åˆ†æ</span></li>
          <li class="sb-row disabled"><span class="sb-txt">è´¢åŠ¡æ•°æ®åˆ†æ</span></li>
          <li class="sb-row disabled"><span class="sb-txt">æ•°æ®ç»¼åˆåˆ†æ</span></li>
        </ul>
      </li>
    </ul>
  </aside>

  
  <!-- å³ä¾§ï¼ˆå¿…é¡»ä¸ aside åŒçº§ï¼Œä¸”å…±åŒåŒ…åœ¨ layout-main å†…ï¼‰ -->
  <section class="main-right">
    <div class="breadcrumb-bar">
      <a href=" " class="back-link">â† è¿”å›é¡¹ç›®åˆ—è¡¨</a >
      <span class="sep">/</span> <span>Test2</span>
      <span class="sep">/</span> <span>20251022</span>
      <span class="sep">/</span> <b>é“¶è¡Œæµæ°´åˆ†æ</b>
    </div>
    
    <!-- 2) KPI + æ•°æ®é—®é¢˜åˆ†æï¼ˆæ•´å—ï¼‰ -->
    <div class="kpi-and-issue">
      <!-- å·¦ä¾§ KPI æ€»å®¹å™¨ï¼šå·¦1åˆ—(å‰ä¸‰ä¸ªçºµæ’) + å³2åˆ—(åå››ä¸ª2Ã—2) -->
      <div class="kpi-grid">
        <div class="kpi k1">
          <div class="kpi-label">è¢«å®¡è®¡å•ä½</div>
          <div class="kpi-value">1 å®¶</div>
        </div>
        <div class="kpi k2">
          <div class="kpi-label">å¯¹æ‰‹æ–¹</div>
          <div class="kpi-value">29 å®¶</div>
        </div>
        <div class="kpi k3">
          <div class="kpi-label">è´¦å·</div>
          <div class="kpi-value">17 ä¸ª</div>
        </div>
    
        <div class="kpi k4">
          <div class="kpi-label">äº¤æ˜“æ€»é¢</div>
          <div class="kpi-value">562.2 K</div>
        </div>
        <div class="kpi k5">
          <div class="kpi-label">æµæ°´æ€»æ•°</div>
          <div class="kpi-value">145 æ¡</div>
        </div>
        <div class="kpi k6">
          <div class="kpi-label">æµå…¥æ€»é¢</div>
          <div class="kpi-value pos"><a class="link-num" href="javascript:;">270.2 K</a ></div>
        </div>
        <div class="kpi k7">
          <div class="kpi-label">æµå‡ºé‡‘é¢</div>
          <div class="kpi-value neg"><a class="link-num danger" href="javascript:;">292.0 K</a ></div>
        </div>
      </div>
    
      <!-- å³ä¾§ï¼šæ•°æ®é—®é¢˜åˆ†æ -->
      <!-- æ•°æ®é—®é¢˜åˆ†æå¡ -->
      <aside class="issue-card">
        <div class="issue-head">
          <span class="issue-title">æ•°æ®é—®é¢˜åˆ†æ</span>
        </div>
        <!-- æ»šåŠ¨å†…å®¹åŒº -->
        <div class="issue-body-simple">
          <p class="issue-note">
            <b>ä»…ä¾›é¢„è§ˆåˆ†æï¼š</b>
            å½“å‰æ•°æ®å­˜åœ¨æœªè®¤é¢† / é“¶è¡Œè´¦å·ä¸»æ¡£ä¸å®Œæ•´çš„é—®é¢˜ï¼Œä»…ä¾›é¡¹ç›®ç»„è¿›è¡Œé£é™©è¯„ä¼°ï¼Œå®è´¨æ€§å®¡è®¡ç¨‹åºä¸å¯ä¾èµ–ã€‚
          </p >
      
          <p class="issue-inline">
            <span class="dot-danger"></span>
            <span>å­˜åœ¨æœªè®¤é¢†çš„åŸå§‹æµæ°´æ–‡ä»¶ï¼Œè¯·åŠæ—¶è®¤é¢†ã€‚</span>
            <a class="issue-inline-link" href="#è®¤é¢†é¡µé¢">ç‚¹å‡»è·³è½¬ Â»</a >
          </p >
      
          <!-- å¯è¿½åŠ æ›´å¤šé—®é¢˜ -->
          <p class="issue-inline">
            <span class="dot-danger"></span>
            <span>é“¶è¡Œæµæ°´ä¸­ï¼Œå­˜åœ¨æœªåœ¨é“¶è¡Œè´¦å·ä¸»æ¡£ç»´æŠ¤çš„è´¦å·ï¼Œè¯·è¡¥å……é“¶è¡Œè´¦å·ä¸»æ¡£</span>
            <a class="issue-inline-link" href="#è¯¦æƒ…">ç‚¹å‡»è·³è½¬ Â»</a >
          </p >

          <p class="issue-inline">
            <span class="dot-danger"></span>
            <span>å­˜åœ¨æ±‡ç‡æœªè½¬æ¢çš„æµæ°´ï¼Œè¯·åŠæ—¶è¡¥å……æ±‡ç‡ä¸»æ¡£</span>
            <a class="issue-inline-link" href="#è¯¦æƒ…">ç‚¹å‡»è·³è½¬ Â»</a >
          </p >

          <p class="issue-inline">
            <span class="dot-danger"></span>
            <span>å­˜åœ¨å½“æ—¥ä¸è¿ç»­çš„æµæ°´æ–‡ä»¶ï¼Œå¯åœ¨æœˆåº¦åˆ†å¸ƒå¤„æ‰‹å·¥æ‰“æ ‡é¦–å°¾ç¬”é‡æ–°éªŒè¯ï¼Œè¯·åŠæ—¶å¤„ç†å¹¶ç¡®è®¤æ— è¯¯</span>
            <a class="issue-inline-link" href="#è¯¦æƒ…">ç‚¹å‡»è·³è½¬ Â»</a >
          </p >
        </div>
      
        <!-- å›ºå®šåº•æ ï¼šå±•å¼€è¯¦æƒ… -->
        <a class="issue-toggle" href="javascript:void(0)">å±•å¼€è¯¦æƒ…</a >
      </aside>
    
    <!-- 3) Tabsï¼ˆç´§è´´åœ¨KPI/é—®é¢˜å¡ä¸‹é¢ï¼‰ -->
    <div class="tab-container">
      <div class="tabbar" id="topTabs">
        <div class="tab active" data-top="account">è´¦æˆ·æ€»è§ˆ</div>
        <div class="tab" data-top="biz">ç»è¥å®è´¨</div>
        <div class="tab" data-top="relation">å·²çŸ¥å…³è”æ–¹äº¤æ˜“</div>
        <div class="tab" data-top="transaction">ç‰¹å®šäº¤æ˜“æŸ¥è¯¢</div>
        <div class="tab" data-top="routine">ç‰¹å®šå·¥å•†æŸ¥è¯¢</div>
        <div class="tab" data-top="statement">æµæ°´æŸ¥è¯¢</div>
        <div class="tab" data-top="verify">æ€»è´¦æ ¸å¯¹</div>
        <i class="inkbar" id="inkbar"></i>
      </div>
    
      <!-- âœ… è¯´æ˜æ¡æ”¾åœ¨åŒä¸€ä¸ªæ¡†å†… -->
      <div class="tab-intro" id="tabIntro"></div>
     </div>
    
    <!-- ç»Ÿä¸€ç™½æ¿èˆå°ï¼šä¸¤ä¸ªé¢æ¿å…±ç”¨åŒä¸€å—â€œç™½æ¿â€ -->
    <div class="tab-stage">
    
      <!-- ===================== ç»è¥å®è´¨ é¢æ¿ ===================== -->
      <section class="tab-pane" id="pane-biz">
        <div class="tab-scroll">
      
          <!-- 1) ç­›é€‰åŒº -->
          <div class="filter-card">
            <div class="filter-area">
              <label>è¢«å®¡è®¡å•ä½å…¬å¸ï¼š</label>
              <span class="select-wrap">
                <select class="select" id="fCompany"></select>
                <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
              </span>
              <label class="negate"><input type="checkbox" id="negCompany">ä¸åŒ…å«</label>
      
              <label>é“¶è¡Œè´¦æˆ·ï¼š</label>
              <span class="select-wrap">
                <select class="select" id="fBank"></select>
                <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
              </span>
              <label class="negate"><input type="checkbox" id="negBank">ä¸åŒ…å«</label>
      
              <label>å…¬å¸èŒèƒ½ï¼š</label>
              <span class="select-wrap">
                <select class="select" id="fFunc"></select>
                <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
              </span>
              <label class="negate"><input type="checkbox" id="negFunc">ä¸åŒ…å«</label>
      
              <label>åˆ†ææ—¶é—´ï¼š</label>
              <input type="date" id="beginDate" />
              <span class="range-sep">è‡³</span>
              <input type="date" id="endDate" />
      
              <label>å¯¹æ‰‹æ–¹ç±»å‹ï¼š</label>
              <span class="select-wrap">
                <select class="select" id="fType">
                  <option value="all">å…¨éƒ¨</option><option>å®¢æˆ·</option><option>ä¾›åº”å•†</option><option>å‘˜å·¥</option>
                </select>
                <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
              </span>
      
              <button class="query" id="btnQueryBiz">æŸ¥è¯¢</button>
              <button class="reset" id="btnResetBiz">é‡ç½®</button>
            </div>
          </div>
      
          <!-- 2) èµ„é‡‘æµæ°´é‡‘é¢ -->
          <div class="panel">
            <div class="panel-head">
              <div class="ph-left">
                <div class="ph-title">èµ„é‡‘æµæ°´é‡‘é¢</div>
                <button class="btn" id="btnAccountLogic">ä¸šåŠ¡é€»è¾‘</button>
                <button class="btn" id="btnAccountTips">æ“ä½œæç¤º</button>
              </div>
              <div class="ph-right">
                <span class="note-link"><i class="icon">
                  <svg viewBox="0 0 24 24"><path d="M12 3v18M5 6h14M5 12h14M5 18h9" fill="none" stroke="currentColor" stroke-width="1.6"/></svg>
                </i><u>å¤‡æ³¨è¯´æ˜</u></span>
                <span class="pill-wrap">
                  <select id="yearBalance" class="pill-select">
                    <option>2023-2024</option><option>2023</option><option>2024</option>
                  </select>
                  <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
                </span>
              </div>
            </div>
      
      
            <div id="chart-balance" class="chart-lg"></div>
          </div>
      
          <!-- 3) æµå…¥æµå‡ºè¶‹åŠ¿ -->
          <div class="panel">
            <div class="panel-head">
              <div class="ph-left">
                <div class="ph-title">æµå…¥æµå‡ºè¶‹åŠ¿</div>
                <button class="btn" id="btnAccountLogic">ä¸šåŠ¡é€»è¾‘</button>
                <button class="btn" id="btnAccountTips">æ“ä½œæç¤º</button>
              </div>
              <div class="ph-right">
                <span class="note-link"><i class="icon">
                  <svg viewBox="0 0 24 24"><path d="M12 3v18M5 6h14M5 12h14M5 18h9" fill="none" stroke="currentColor" stroke-width="1.6"/></svg>
                </i><u>å¤‡æ³¨è¯´æ˜</u></span>
      
                <span class="pill-wrap">
                  <select id="yearIO" class="pill-select">
                    <option>2023-2024</option><option>2023</option><option>2024</option>
                  </select>
                  <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
                </span>
      
                <span class="pill-wrap">
                  <select id="ctypeIO" class="pill-select">
                    <option value="all">å…¨éƒ¨ç±»å‹</option><option>ä¾›åº”å•†</option><option>å®¢æˆ·</option><option>å‘˜å·¥</option><option>å…¶ä»–</option><option>ä¸ªäºº</option>
                  </select>
                  <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
                </span>
              </div>
            </div>
      
            <div class="kpi-row" id="kpi-io">
              <div class="kpi"><div class="k">æµå…¥é‡‘é¢</div><div class="v" id="io_in_sum">â€”</div></div>
              <div class="kpi"><div class="k">æœˆå‡æµå…¥</div><div class="v" id="io_in_avg">â€”</div></div>
              <div class="kpi"><div class="k">æµå‡ºæ€»é¢</div><div class="v" id="io_out_sum">â€”</div></div>
              <div class="kpi"><div class="k">æœˆå‡æµå‡º</div><div class="v" id="io_out_avg">â€”</div></div>
            </div>
      
            <div id="chart-io" class="chart-md"></div>
          </div>
      
          <!-- 4) æµå…¥æµå‡ºæ„æˆï¼ˆæ ‡é¢˜ + Tab + 7å æ¯” + å·¦å³ä¸¤å›¾ï¼‰ -->
          <div class="panel">
            <div class="panel-head">
              <div class="ph-left">
                <div class="ph-title">æµå…¥æµå‡ºæ„æˆ</div>
                <button class="btn" id="btnAccountLogic">ä¸šåŠ¡é€»è¾‘</button>
                <button class="btn" id="btnAccountTips">æ“ä½œæç¤º</button>
              </div>
              <div class="ph-right">
                <span class="note-link"><i class="icon">
                  <svg viewBox="0 0 24 24"><path d="M12 3v18M5 6h14M5 12h14M5 18h9" fill="none" stroke="currentColor" stroke-width="1.6"/></svg>
                </i><u>å¤‡æ³¨è¯´æ˜</u></span>
              </div>
            </div>
      
            <div class="tabs-mini" id="compTabs">
              <div class="tab active" data-mode="total">äº¤æ˜“æ€»é¢</div>
              <div class="tab" data-mode="in">æµå…¥æ–¹</div>
              <div class="tab" data-mode="out">æµå‡ºæ–¹</div>
            </div>
      
            <div class="seven-cats" id="compCats"></div>
      
            <div class="grid-2">
              <div id="chart-comp-monthly" class="chart-md"></div>
              <div id="chart-comp-top20"  class="chart-md"></div>
            </div>
      
            <!-- å·¥å…·æ ï¼šå·¦ä¾§åˆ‡æ¢ / å³ä¾§æŒ‰é’®ç»„ -->
            <div class="table-toolbar">
              <!-- å·¦ï¼šä¸¤æ®µå¼åˆ‡æ¢ -->
              <div class="seg" id="tblSwitcher" role="tablist" aria-label="æ˜ç»†è§†å›¾åˆ‡æ¢">
                <button class="opt active" role="tab" aria-selected="true" data-view="deal">äº¤æ˜“æ˜ç»†</button>
                <button class="opt" role="tab" aria-selected="false" data-view="corp">å·¥å•†ä¿¡æ¯</button>
              </div>
            
              <!-- å³ï¼šåŠŸèƒ½æŒ‰é’® -->
              <div class="btn-bar">
                <button class="btn ghost" id="btnQuick">å¿«é€ŸæŸ¥çœ‹å‹¾é€‰ç»“æœ</button>
                <button class="btn ghost" id="btnReset">é‡ç½®ç­›é€‰</button>
                <button class="btn ghost" id="btnHead">è‡ªå®šä¹‰è¡¨å¤´</button>
                <button class="btn ghost" id="btnDist">æµå…¥æµå‡ºåˆ†å¸ƒ</button>
                <button class="btn primary" id="btnAnalyze">ç”Ÿæˆåˆ†æç»“æœ</button>
                <button class="btn primary" id="btnFlow">ç”Ÿæˆæµæ°´</button>
              </div>
            </div>

            <!-- è¡¨æ ¼ä¸Šæ–¹æç¤ºè¡Œï¼šå·¦ä¾§ + å³ä¾§å„ä¸€æ¡ -->
            <div class="table-announce" id="tableAnnounce">
              <div class="left-msg">
                å½“å‰å·¥ä½œç°¿ä¸‹æ€»è®¡æœ‰
                <strong id="fraudCount" style="font-weight:700;">0</strong>
                ä¸ªå¯¹æ‰‹æ–¹å­˜åœ¨é…åˆé€ å‡è¡Œä¸ºï¼Œè¯·å…³æ³¨ï¼
                ï¼ˆAQPP-Audit æä¾›çš„å…¨é‡é…åˆé€ å‡æ¸…å•è§
                <span class="file-link" id="fraudListFile">ç¬¬ä¸‰æ–¹é…åˆé€ å‡åå•.xlsx</span>ï¼‰
              </div>
              <div class="right-msg">ä¸å‹¾é€‰å³é»˜è®¤åŸºäºå…¨éƒ¨è®°å½•å¯¼å‡º</div>
            </div>
      
            <div id="tbl-deal-wrap">
              <table class="table" id="tblDeal">
                <thead>
                <tr>
                  <th>å¯¹æ‰‹æ–¹åç§°</th><th>å¯¹æ‰‹æ–¹ç±»å‹</th><th>å…³è”å…³ç³»</th><th>é»‘åå•</th>
                  <th>æµå…¥æ€»é¢</th><th>æµå‡ºæ€»é¢</th><th>äº¤æ˜“æ€»é¢</th><th>äº¤æ˜“æ€»é¢å æ¯”</th><th>äº¤æ˜“ç¬”æ•°</th>
                  <th>é”€å”®ç±»åˆ«</th><th>é‡‡è´­ç±»åˆ«</th><th>èŒä½</th><th>å¤‡æ³¨è¯´æ˜</th><th>æ“ä½œ</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
              <div id="pagination-deal" class="pagination"></div>
            </div>
      
            <div id="tbl-corp-wrap" class="hide">
              <table class="table" id="tblCorp">
                <thead>
                <tr>
                  <th>å¯¹æ‰‹æ–¹åç§°</th><th>äº¤æ˜“æ€»é¢</th><th>æˆç«‹æ—¥æœŸ</th><th>ç»è¥å¼€å§‹æ—¶é—´</th>
                  <th>ç»è¥ç»“æŸæ—¶é—´</th><th>è¥ä¸šæœŸé™</th><th>ç»è¥çŠ¶æ€</th><th>æ³¨å†Œèµ„æœ¬</th>
                  <th>è¡Œä¸š</th><th>ç»è¥èŒƒå›´</th><th>æ³¨å†Œåœ°å€</th><th>ä¼ä¸šè”ç³»æ–¹å¼</th><th>è‘£ç›‘é«˜</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
              <div id="pagination-corp" class="pagination"></div>
            </div>
          </div>
      
        </div>
      </section>

      <!-- ===================== è´¦æˆ·æ€»è§ˆé¡µ ===================== -->
      <section class="tab-pane active" id="pane-account">
        <div class="tab-scroll">
      
          <!-- ========== èµ„é‡‘æ€»è§ˆ ========== -->
          <div class="card">
            <div class="head">
              <div class="title">èµ„é‡‘æ€»è§ˆ</div>
      
              <!-- ç´§è·Ÿæ ‡é¢˜ï¼šä¸šåŠ¡é€»è¾‘ / æ“ä½œæç¤º -->
              <div class="head-inline" style="margin-left:8px;display:flex;gap:8px;">
                <button class="btn" id="btnAccountLogic">ä¸šåŠ¡é€»è¾‘</button>
                <button class="btn" id="btnAccountTips">æ“ä½œæç¤º</button>
              </div>
      
              <!-- å³ä¾§ï¼šè‡ªå®šä¹‰è¡¨å¤´ / ç”Ÿæˆåˆ†æç»“æœ -->
              <div style="margin-left:auto;display:flex;gap:8px;align-items:center;">
                <button class="btn" id="btnCustomizeCols">è‡ªå®šä¹‰è¡¨å¤´</button>
                <button class="btn primary" id="btnAnalyze">ç”Ÿæˆåˆ†æç»“æœ</button>
              </div>
            </div>
      
            <div class="content">
      
              <!-- çŠ¶æ€å›¾ä¾‹ï¼ˆé å³ï¼‰ -->
              <div class="small" style="display:flex;gap:16px;justify-content:flex-end;margin-bottom:8px;">
                <span><i style="width:10px;height:10px;border-radius:50%;background:#facc15;display:inline-block;"></i> å½“æ—¥ä½™é¢ä¸è¿ç»­</span>
                <span><i style="width:10px;height:10px;border-radius:50%;background:#cbd5e1;display:inline-block;"></i> æ— æµæ°´æ•°æ®</span>
                <span><i style="width:10px;height:10px;border-radius:50%;background:#3b82f6;display:inline-block;"></i> æ£€éªŒæ— è¯¯</span>
                <span><i style="width:10px;height:10px;border-radius:50%;background:#ef4444;display:inline-block;"></i> ä½™é¢é”™è¯¯</span>
              </div>
      
              <!-- æ€»è§ˆè¡¨ -->
              <div style="overflow:auto">
                <div id="checkScope" class="check-scope">
                  <table class="table" id="tblAccountSummary">
                    <thead>
                      <tr>
                        <th class="sortable">è¢«å®¡è®¡å•ä½å…¬å¸</th>
                        <th class="sortable">æœ¬æ–¹è´¦å·</th>
                        <th class="sortable">é“¶è¡Œåç§°</th>
                        <th class="sortable">æµå…¥æ€»é¢</th>
                        <th class="sortable">æµå‡ºæ€»é¢</th>
                        <th class="sortable">äº¤æ˜“æ€»é¢</th>
                        <th class="sortable">äº¤æ˜“æ€»é¢å æ¯”</th>
                        <th class="sortable">äº¤æ˜“ç¬”æ•°</th>
                        <th class="sortable">å¯¹æ‰‹æ–¹æ•°é‡</th>
                        <th>æµæ°´æ–‡ä»¶</th>
                        <th>æ“ä½œ</th>
                    
                        <th class="check-col">
                          <div class="check-head">
                            <button class="arrow-btn" id="btnToggleCheck" title="å±•å¼€/æ”¶èµ·2023å¹´">
                              <svg viewBox="0 0 16 16" aria-hidden="true">
                                <path d="M6.2 3.5l5 4.5-5 4.5V3.5z" />
                              </svg>
                            </button>
                            <span>æ ¡éªŒæƒ…å†µï¼š</span>
                            <div class="y-labels">
                              <span class="y y-2023">2023</span>
                              <span class="sep-label">ï½œ</span>
                              <span class="y y-2024">2024</span>
                            </div>
                          </div>
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- åˆè®¡è¡Œ -->
                      <tr class="sum-row">
                        <td><strong>åˆè®¡</strong></td><td></td><td></td>
                        <td style="color:#2563eb"><strong>846,223,016</strongb></td><td style="color:#ef4444"><strong>693,427,537</strong></td><td><strong>1,539,650,553</strong></td>
                        <td><strong>100.00%</strong></td><td><strong>2,442</strong></td><td><strong>401</strong></td><td></td><td></td>
                        <td class="check-col">
                          <div class="months-grid">
                            <span class="month-num col-2023">1</span><span class="month-num col-2023">2</span>
                            <span class="month-num col-2023">3</span><span class="month-num col-2023">4</span>
                            <span class="month-num col-2023">5</span><span class="month-num col-2023">6</span>
                            <span class="month-num col-2023">7</span><span class="month-num col-2023">8</span>
                            <span class="month-num col-2023">9</span><span class="month-num col-2023">10</span>
                            <span class="month-num col-2023">11</span><span class="month-num col-2023">12</span>
                            <span class="col-sep"></span>
                            <span class="month-num">1</span><span class="month-num">2</span>
                            <span class="month-num">3</span><span class="month-num">4</span>
                            <span class="month-num">5</span><span class="month-num">6</span>
                            <span class="month-num">7</span><span class="month-num">8</span>
                            <span class="month-num">9</span><span class="month-num">10</span>
                            <span class="month-num">11</span><span class="month-num">12</span>
                          </div>
                        </td>
                      </tr>
              
                      <!-- æ•°æ®è¡Œï¼ˆä»…ä¸€è¡Œåœ†ç‚¹ï¼‰ -->
                      <tr>
                        <td>abcæœ‰é™å…¬å¸</td>
                        <td>574***0001</td>
                        <td>æ‹›å•†é“¶è¡Œ</td>
                        <td style="color:#2563eb">846,223,016</td>
                        <td style="color:#ef4444">693,427,537</td>
                        <td><b>1,539,650,553</b></td>
                        <td>100.00%</td>
                        <td>2,442</td>
                        <td>401</td>
                        <td>1</td>
                        <td class="actions">
                        <a href=" " title="è´¦å·è¯¦æƒ…"><i class="fa-solid fa-eye"></i></a >
                        <a href="#" title="æ–‡ä»¶è¯¦æƒ…"><i class="fa-regular fa-file-lines"></i></a >
                        </td>
                        <td class="check-col">
                          <div class="months-grid check-row">
                            <i class="chk-dot chk-ok col-2023" title="2023-01"></i>
                            <i class="chk-dot chk-ok col-2023" title="2023-02"></i>
                            <i class="chk-dot chk-err col-2023" title="2023-03"></i>
                            <i class="chk-dot chk-ok col-2023" title="2023-04"></i>
                            <i class="chk-dot chk-ok col-2023" title="2023-05"></i>
                            <i class="chk-dot chk-ok col-2023" title="2023-06"></i>
                            <i class="chk-dot chk-warn col-2023" title="2023-07"></i>
                            <i class="chk-dot chk-ok col-2023" title="2023-08"></i>
                            <i class="chk-dot chk-ok col-2023" title="2023-09"></i>
                            <i class="chk-dot chk-ok col-2023" title="2023-10"></i>
                            <i class="chk-dot chk-err col-2023" title="2023-11"></i>
                            <i class="chk-dot chk-ok col-2023" title="2023-12"></i>
                            <span class="col-sep"></span>
                            <i class="chk-dot chk-ok" title="2024-01"></i>
                            <i class="chk-dot chk-ok" title="2024-02"></i>
                            <i class="chk-dot chk-ok" title="2024-03"></i>
                            <i class="chk-dot chk-warn" title="2024-04"></i>
                            <i class="chk-dot chk-ok" title="2024-05"></i>
                            <i class="chk-dot chk-ok" title="2024-06"></i>
                            <i class="chk-dot chk-none" title="2024-07"></i>
                            <i class="chk-dot chk-ok" title="2024-08"></i>
                            <i class="chk-dot chk-ok" title="2024-09"></i>
                            <i class="chk-dot chk-ok" title="2024-10"></i>
                            <i class="chk-dot chk-err" title="2024-11"></i>
                            <i class="chk-dot chk-ok" title="2024-12"></i>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
      
              <div id="pagination-account" class="pagination"></div>
            </div>
          </div>
      
          <!-- ========== ç¼ºå¤±åŒåè´¦æˆ·ï¼ˆä¸å˜ï¼Œä»…æé†’ï¼šå­—æ®µå·²æŒ‰ä½ è¦æ±‚æ›´æ–°ï¼‰ ========== -->
          <div class="card">
            <div class="head">
              <div class="title">ç¼ºå¤±åŒåè´¦æˆ·</div>
      
              <div class="head-inline" style="margin-left:8px;display:flex;gap:8px;">
                <button class="btn" id="btnAccountLogic">ä¸šåŠ¡é€»è¾‘</button>
                <button class="btn" id="btnAccountTips">æ“ä½œæç¤º</button>
              </div>
      
              <div style="margin-left:auto;display:flex;gap:8px;align-items:center;">
                <button class="btn primary" id="btnAnalyze">ç”Ÿæˆåˆ†æç»“æœ</button>
                <button class="btn primary" id="btnFlow">ç”Ÿæˆæµæ°´</button>
              </div>
            </div>
      
            <div class="content">
              <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:10px;">
                <div class="top-item"><div class="lbl small">äº¤æ˜“æ€»é¢</div><div class="num">0.00</div></div>
                <div class="top-item"><div class="lbl small">æµå…¥æœ¬æ–¹æ€»é¢</div><div class="num" style="color:#2563eb">0.00</div></div>
                <div class="top-item"><div class="lbl small">æœ¬æ–¹æµå‡ºæ€»é¢</div><div class="num" style="color:#ef4444">0.00</div></div>
                <div class="top-item"><div class="lbl small">å·²è§£é‡Š/æ€»æ•°</div><div class="num">0 / 5</div></div>
              </div>
      
              <div style="overflow:auto;">
                <table class="table" id="tblMissingSameName">
                  <thead>
                    <tr>
                      <th>å¯¹æ‰‹æ–¹åç§°ï¼ˆè¢«å®¡è®¡å•ä½ï¼‰</th>
                      <th class="sortable">ç¼ºå¤±é“¶è¡Œè´¦å·</th>
                      <th class="sortable">æµå…¥æœ¬æ–¹æ€»é¢</th>
                      <th class="sortable">å æ¯”</th>
                      <th class="sortable">æœ¬æ–¹æµå‡ºæ€»é¢</th>
                      <th class="sortable">å æ¯”</th>
                      <th class="sortable">äº¤æ˜“æ¬¡æ•°</th>
                      <th class="sortable">å æ¯”</th>
                      <th>ç¼ºå¤±åŸå› </th>
                      <th>æ”¯æŒæ€§æ–‡ä»¶ç´¢å¼•</th>
                      <th>æ“ä½œ</th>
                    </tr>
                  </thead>
              
                  <tbody>
                    <!-- ====== æ±‡æ€»è¡Œï¼ˆå¯å±•å¼€/æ”¶èµ·ï¼‰ ====== -->
                    <tr class="group-row" data-group="abc">
                      <td>
                        <button class="expand-btn expanded" title="å±•å¼€/æ”¶èµ·æ˜ç»†">â–¼</button>
                        <strong>abcæœ‰é™å…¬å¸</strong>ã€€<span class="text-muted">å·²è§£é‡Š/æ€»æ•°ï¼š0/5</span>
                      </td>
                      <td></td>
                      <td style="color:#2563eb"><strong>12,360,000</strong></td>
                      <td><strong>74.15%</strong></td>
                      <td style="color:#ef4444"><strong>12,360,000</strong></td>
                      <td><strong>100.00%</strong></td>
                      <td><strong>26</strong></td>
                      <td><strong>38.40%</strong></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
              
                    <!-- ====== æ˜ç»†è¡Œï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰ ====== -->
                    <tr class="detail-row group-abc">
                      <td>ã€€â”” abcæœ‰é™å…¬å¸</td>
                      <td>6214 **** 8890</td>
                      <td>2,160,000</td>
                      <td>17.47%</td>
                      <td style="color:#ef4444">2,160,000</td>
                      <td>17.47%</td>
                      <td>8</td>
                      <td>30.77%</td>
                      <td></td>
                      <td></td>
                      <td class="actions">
                      <a href="#" title="æµæ°´æ˜ç»†"><i class="fa-regular fa-file-lines"></i></a >
                      </td>
                    </tr>
              
                    <tr class="detail-row group-abc">
                      <td>ã€€â”” abcæœ‰é™å…¬å¸</td>
                      <td>3941 **** 2193</td>
                      <td>1,500,000</td>
                      <td>12.14%</td>
                      <td style="color:#ef4444">1,500,000</td>
                      <td>12.14%</td>
                      <td>5</td>
                      <td>19.23%</td>
                      <td></td>
                      <td></td>
                      <td class="actions">
                      <a href="#" title="æµæ°´æ˜ç»†"><i class="fa-regular fa-file-lines"></i></a >
                      </td>
                    </tr>
              
                    <tr class="detail-row group-abc">
                      <td>ã€€â”” abcæœ‰é™å…¬å¸</td>
                      <td>2170 **** 7797</td>
                      <td>1,900,000</td>
                      <td>15.37%</td>
                      <td style="color:#ef4444">1,900,000</td>
                      <td>15.37%</td>
                      <td>4</td>
                      <td>15.38%</td>
                      <td></td>
                      <td></td>
                      <td class="actions">
                      <a href="#" title="æµæ°´æ˜ç»†"><i class="fa-regular fa-file-lines"></i></a >
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
      
        </div>
      </section>

      <!-- =====================å·²çŸ¥å…³è”äº¤æ˜“ é¢æ¿ ===================== -->
      <section class="tab-pane" id="pane-relation">
        <div class="tab-scroll">
      
          <!-- 1) ç­›é€‰åŒº -->
          <div class="filter-card">
            <div class="filter-area">
              <label>è¢«å®¡è®¡å•ä½å…¬å¸ï¼š</label>
              <span class="select-wrap">
                <select class="select" id="fCompany"></select>
                <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
              </span>
              <label class="negate"><input type="checkbox" id="negCompany">ä¸åŒ…å«</label>
      
              <label>é“¶è¡Œè´¦æˆ·ï¼š</label>
              <span class="select-wrap">
                <select class="select" id="fBank"></select>
                <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
              </span>
              <label class="negate"><input type="checkbox" id="negBank">ä¸åŒ…å«</label>
      
              <label>å…¬å¸èŒèƒ½ï¼š</label>
              <span class="select-wrap">
                <select class="select" id="fFunc"></select>
                <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
              </span>
              <label class="negate"><input type="checkbox" id="negFunc">ä¸åŒ…å«</label>
      
              <label>åˆ†ææ—¶é—´ï¼š</label>
              <input type="date" id="beginDate" />
              <span class="range-sep">è‡³</span>
              <input type="date" id="endDate" />
      
              <label>å¯¹æ‰‹æ–¹ç±»å‹ï¼š</label>
              <span class="select-wrap">
                <select class="select" id="fType">
                  <option value="all">å…¨éƒ¨</option><option>å®¢æˆ·</option><option>ä¾›åº”å•†</option><option>å‘˜å·¥</option>
                </select>
                <i class="chev"><svg viewBox="0 0 24 24"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg></i>
              </span>
      
              <button class="query" id="btnQueryBiz">æŸ¥è¯¢</button>
              <button class="reset" id="btnResetBiz">é‡ç½®</button>
            </div>
          </div>
               
      
          <!-- 4) æµå…¥æµå‡ºæ„æˆï¼ˆæ ‡é¢˜ + Tab + 7å æ¯” + å·¦å³ä¸¤å›¾ï¼‰ -->
          <div class="panel">
            <div class="panel-head">
              <div class="ph-left">
                <div class="ph-title">æµå…¥æµå‡ºæ„æˆ</div>
                <button class="btn" id="btnAccountLogic">ä¸šåŠ¡é€»è¾‘</button>
                <button class="btn" id="btnAccountTips">æ“ä½œæç¤º</button>
              </div>
              <div class="ph-right">
                <span class="note-link"><i class="icon">
                  <svg viewBox="0 0 24 24"><path d="M12 3v18M5 6h14M5 12h14M5 18h9" fill="none" stroke="currentColor" stroke-width="1.6"/></svg>
                </i><u>å¤‡æ³¨è¯´æ˜</u></span>
              </div>
            </div>
      
            <div class="tabs-mini" id="compTabs">
              <div class="tab active" data-mode="total">äº¤æ˜“æ€»é¢</div>
              <div class="tab" data-mode="in">æµå…¥æ–¹</div>
              <div class="tab" data-mode="out">æµå‡ºæ–¹</div>
            </div>
      
            <div class="seven-cats" id="compCats"></div>
      
            <div class="grid-2">
              <div id="chart-comp-monthly" class="chart-md"></div>
              <div id="chart-comp-top20"  class="chart-md"></div>
            </div>
      
            <!-- å·¥å…·æ ï¼šå·¦ä¾§åˆ‡æ¢ / å³ä¾§æŒ‰é’®ç»„ -->
            <div class="table-toolbar">
              <!-- å·¦ï¼šä¸¤æ®µå¼åˆ‡æ¢ -->
              <div class="seg" id="tblSwitcher" role="tablist" aria-label="æ˜ç»†è§†å›¾åˆ‡æ¢">
                <button class="opt active" role="tab" aria-selected="true" data-view="deal">äº¤æ˜“æ˜ç»†</button>
                <button class="opt" role="tab" aria-selected="false" data-view="corp">å·¥å•†ä¿¡æ¯</button>
              </div>
            
              <!-- å³ï¼šåŠŸèƒ½æŒ‰é’® -->
              <div class="btn-bar">
                <button class="btn ghost" id="btnQuick">å¿«é€ŸæŸ¥çœ‹å‹¾é€‰ç»“æœ</button>
                <button class="btn ghost" id="btnReset">é‡ç½®ç­›é€‰</button>
                <button class="btn ghost" id="btnHead">è‡ªå®šä¹‰è¡¨å¤´</button>
                <button class="btn ghost" id="btnDist">æµå…¥æµå‡ºåˆ†å¸ƒ</button>
                <button class="btn primary" id="btnAnalyze">ç”Ÿæˆåˆ†æç»“æœ</button>
                <button class="btn primary" id="btnFlow">ç”Ÿæˆæµæ°´</button>
              </div>
            </div>

            <!-- è¡¨æ ¼ä¸Šæ–¹æç¤ºè¡Œï¼šå·¦ä¾§ + å³ä¾§å„ä¸€æ¡ -->
            <div class="table-announce" id="tableAnnounce">
              <div class="left-msg">
                å½“å‰å·¥ä½œç°¿ä¸‹æ€»è®¡æœ‰
                <strong id="fraudCount" style="font-weight:700;">0</strong>
                ä¸ªå¯¹æ‰‹æ–¹å­˜åœ¨é…åˆé€ å‡è¡Œä¸ºï¼Œè¯·å…³æ³¨ï¼
                ï¼ˆAQPP-Audit æä¾›çš„å…¨é‡é…åˆé€ å‡æ¸…å•è§
                <span class="file-link" id="fraudListFile">ç¬¬ä¸‰æ–¹é…åˆé€ å‡åå•.xlsx</span>ï¼‰
              </div>
              <div class="right-msg">ä¸å‹¾é€‰å³é»˜è®¤åŸºäºå…¨éƒ¨è®°å½•å¯¼å‡º</div>
            </div>
      
            <div id="tbl-deal-wrap">
              <table class="table" id="tblDeal">
                <thead>
                <tr>
                  <th>å¯¹æ‰‹æ–¹åç§°</th><th>å¯¹æ‰‹æ–¹ç±»å‹</th><th>å…³è”å…³ç³»</th><th>é»‘åå•</th>
                  <th>æµå…¥æ€»é¢</th><th>æµå‡ºæ€»é¢</th><th>äº¤æ˜“æ€»é¢</th><th>äº¤æ˜“æ€»é¢å æ¯”</th><th>äº¤æ˜“ç¬”æ•°</th>
                  <th>é”€å”®ç±»åˆ«</th><th>é‡‡è´­ç±»åˆ«</th><th>èŒä½</th><th>å¤‡æ³¨è¯´æ˜</th><th>æ“ä½œ</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
              <div id="pagination-deal" class="pagination"></div>
            </div>
      
            <div id="tbl-corp-wrap" class="hide">
              <table class="table" id="tblCorp">
                <thead>
                <tr>
                  <th>å¯¹æ‰‹æ–¹åç§°</th><th>äº¤æ˜“æ€»é¢</th><th>æˆç«‹æ—¥æœŸ</th><th>ç»è¥å¼€å§‹æ—¶é—´</th>
                  <th>ç»è¥ç»“æŸæ—¶é—´</th><th>è¥ä¸šæœŸé™</th><th>ç»è¥çŠ¶æ€</th><th>æ³¨å†Œèµ„æœ¬</th>
                  <th>è¡Œä¸š</th><th>ç»è¥èŒƒå›´</th><th>æ³¨å†Œåœ°å€</th><th>ä¼ä¸šè”ç³»æ–¹å¼</th><th>è‘£ç›‘é«˜</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
              <div id="pagination-corp" class="pagination"></div>
            </div>
          </div>
      
        </div>
      </section>
    
      <!-- ===================== ç‰¹å®šå·¥å•†æŸ¥è¯¢ é¢æ¿ ===================== -->
      <section class="tab-pane" id="pane-routine">
        <div class="tab-scroll">
          <div class="split">
            <!-- å·¦ä¾§èœå• -->
            <aside class="sidebar-pane">
              <div class="menu" id="routineMenu">
                <div class="item active" data-code="2.1">1. ç»è¥æ—¶é—´è¾ƒçŸ­</div>
                    <div class="item" data-code="2.2">2. ç¤¾ä¿ç¼´çº³äººæ•°è¾ƒå°‘</div>
                    <div class="item" data-code="2.3">3. ä¸ºä¸ªäººæˆ–ä¸ªä½“å·¥å•†æˆ·</div>
                    <div class="item" data-code="2.3">4. æ³¨å†Œèµ„æœ¬ä¸äº¤æ˜“è§„æ¨¡ä¸åŒ¹é…</div>
                    <div class="item" data-code="2.3">5. äº¤æ˜“è§„æ¨¡ä¸ç¬¬ä¸‰æ–¹æ‰€å¤„è¡Œä¸šçŠ¶å†µä¸åŒ¹é…</div>
                    <div class="item" data-code="2.3">6. ç»è¥èŒƒå›´ä¸äº¤æ˜“æ€§è´¨ä¸åŒ¹é…</div>
                    <div class="item" data-code="2.3">7. æ³¨å†Œåœ°å€ä¸è¢«å®¡è®¡å•ä½åœ°å€è¾ƒä¸ºæ¥è¿‘</div>
                    <div class="item" data-code="2.3">8. ä¸åŒç¬¬ä¸‰æ–¹çš„å·¥å•†ç™»è®°ä¿¡æ¯ç›¸åŒæˆ–ç›¸è¿‘ï¼›</div>
                    <div class="item" data-code="2.3">9. æ—¢æ˜¯å®¢æˆ·åˆæ˜¯ä¾›åº”å•†,æˆ–å—åŒä¸€å®é™…æ§åˆ¶äººæ§åˆ¶</div>
                  <div class="small">è¯´æ˜ï¼šåˆ‡æ¢ Routine ä»…åˆ·æ–°å³ä¾§å†…å®¹ã€‚</div>
                </aside>

                <main>
                  <div class="card">
                    <div class="head">
                      <div class="title" id="rTitle">1. ç»è¥æ—¶é—´è¾ƒçŸ­ Â· ç»“æœ</div>
                      <div class="filters" id="routineFilters"></div>
                    </div>
                    <div class="content">
                      <div class="top-strip" id="topStrip"></div>
                    </div>
                  </div>

                  <div class="grid-2">
                    <!-- å·¦è¾¹ï¼šæ•£ç‚¹å›¾ + Top20 -->
                    <div>
                      <!-- æ•£ç‚¹å›¾ -->
                      <div class="card">
                        <div class="head"><div class="title" id="scatterTitle">æ•£ç‚¹åˆ†å¸ƒï¼ˆå«æ­£æ€æ‹Ÿåˆï¼‰</div></div>
                        <div class="content"><div id="chart-scatter" class="chart"></div></div>
                      </div>

                      <!-- Top20 è¡¨æ ¼ -->
                      <div class="card">
                        <div class="head"><div class="title">Top20 äº¤æ˜“é¢æ€»è§ˆ</div></div>
                        <div class="content" style="display:flex;gap:20px;align-items:flex-start;">

                          <!-- å·¦è¾¹ï¼šTop20 è¡¨æ ¼ -->
                          <div style="flex:3;overflow:auto;">
                            <div class="small">Top20äº¤æ˜“é¢æ€»é¢ï¼š<b id="rankTotal">â€”</b></div>
                            <table class="table" id="tblTop20">
                              <thead>
                                <tr>
                                  <th>æ’å</th>
                                  <th>å¯¹æ‰‹æ–¹åç§°</th>
                                  <th>äº¤æ˜“æ€»é¢</th>
                                  <th>æµå…¥æ€»é¢</th>
                                  <th>æµå‡ºæ€»é¢</th>
                                  <th>äº¤æ˜“ç¬”æ•°</th>
                                  <th>ç±»å‹</th>
                                  <th>å…³è”å…³ç³»</th>
                                  <th>è¡Œä¸š</th>
                                  <th>æ³¨å†Œèµ„æœ¬</th>
                                  <th>æˆç«‹æ—¥æœŸ</th>
                                </tr>
                              </thead>
                              <tbody></tbody>
                            </table>
                          </div>

                          <!-- å³è¾¹ï¼šç¼©å°çš„ç¯å½¢å›¾ -->
                          <div style="flex:1;min-width:220px;max-width:260px;">
                            <div id="chart-donut" class="chart" style="height:220px"></div>
                          </div>

                        </div>
                      </div>

                  <div class="card">
                    <div class="head">
                      <div class="title">äº¤æ˜“æ˜ç»†è¡¨</div>
                      <div class="table-tabs" id="routineTabs">
                        <div class="table-tab active" data-view="flow">æµæ°´è§†å›¾</div>
                        <div class="table-tab" data-view="counter">å¯¹æ‰‹æ–¹è§†å›¾</div>
                      </div>
                    </div>
                    <div class="content" style="overflow:auto;max-height:520px">
                      <table class="table" id="tblRoutineDetail">
                        <thead></thead>
                        <tbody></tbody>
                      </table>
                      <div id="pagination-routine" class="pagination"></div>
                    </div>
                  </div>
                </main>
              </div>
            </section>
          </div>
          <!-- ====== ä½ çš„â€œé“¶è¡Œæµæ°´åˆ†æ Â· å®Œæ•´ç‰ˆâ€å†…å®¹ç»“æŸ ====== -->
        </div>
      </div>
      <footer style="padding:6px 10px;background:#fff;border-top:1px solid #eaecef;font-size:12px"><P>KPMG Audit Compass V3.4.0(2025.2)</P></P>Â© 2025 æ¯•é©¬å¨ç§‘æŠ€æœåŠ¡(é¦™æ¸¯)æœ‰é™å…¬å¸ â€” é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºæœ‰é™è´£ä»»å…¬å¸ï¼Œæ˜¯ä¸è‹±å›½ç§è¥æ‹…ä¿æœ‰é™å…¬å¸ â€” æ¯•é©¬å¨å›½é™…æœ‰é™å…¬å¸ç›¸å…³è”çš„ç‹¬ç«‹æˆå‘˜æ‰€å…¨çƒæ€§ç»„ç»‡ä¸­çš„æˆå‘˜ã€‚ç‰ˆæƒæ‰€æœ‰ï¼Œä¸å¾—è½¬è½½ã€‚ æ¯•é©¬å¨çš„åç§°å’Œæ ‡è¯†å‡ä¸ºæ¯•é©¬å¨å…¨çƒæ€§ç»„ç»‡ä¸­çš„ç‹¬ç«‹æˆå‘˜æ‰€ç»è®¸å¯åä½¿ç”¨çš„å•†æ ‡</P></footer>
    </section>
  </div>


  <!-- ====== é¡µé¢è„šæœ¬ï¼šå®Œæ•´åŠŸèƒ½é€»è¾‘ä¿æŒä¸å˜ ====== -->
  <script>
  /* =============== å·¥å…· =============== */
  function ez(id,opt){const c=echarts.init(document.getElementById(id));c.setOption(opt);window.addEventListener('resize',()=>c.resize());return c;}
  function fmtWan(v){return (Math.round(v*10)/10).toLocaleString()}
  function randPick(arr){return arr[Math.floor(Math.random()*arr.length)]}

  /* =============== é€ æ›´çœŸå®çš„æ•°æ®ï¼ˆæœ¬åœ°éšæœºï¼‰ =============== */
  const companyPrefixes = ['ä¸Šæµ·','åŒ—äº¬','æ·±åœ³','æ­å·','å¹¿å·','å—äº¬','æˆéƒ½','æ­¦æ±‰','è‹å·','å¤©æ´¥','é‡åº†','åˆè‚¥','è¥¿å®‰'];
  const companyMains = ['æ’ä¿¡','å¼˜ä¸š','ä¸­ç§‘','è”åˆ›','ä½³æˆ','å®æ³°','è¿œæ™¯','è“æµ·','æ˜Ÿå®‡','æ–°é”','é¼ç››','åšçº³','å¯èˆª','å¾®è”','ç§‘è¿ˆ','ç‘åš','ç‘å£°','æ­£æ³°','ä¸­æ™º','æ™®å','å¾·å‹¤','å¿—æˆ','èˆªå¤©','åç§‘','é•¿æ±Ÿ','å‡Œäº‘'];
  const companySuffixes = ['ç§‘æŠ€æœ‰é™å…¬å¸','ä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸','å®ä¸šæœ‰é™å…¬å¸','ä¾›åº”é“¾ç®¡ç†æœ‰é™å…¬å¸','ç”µå­å•†åŠ¡æœ‰é™å…¬å¸','å•†ä¸šç®¡ç†æœ‰é™å…¬å¸','è´¸æ˜“æœ‰é™å…¬å¸','ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸','æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸','æ•°æ®ç§‘æŠ€æœ‰é™å…¬å¸','åŒ»è¯æœ‰é™å…¬å¸','ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸'];
  const funcs = ['æ€»éƒ¨','ç ”å‘','é”€å”®','é‡‡è´­','ç”Ÿäº§','è´¢åŠ¡','äººåŠ›','å¸‚åœº','å®¢æœ','æ³•åŠ¡'];
  const banks = ['å·¥è¡Œ','å»ºè¡Œ','å†œè¡Œ','ä¸­è¡Œ','æ‹›è¡Œ','äº¤è¡Œ','æµ¦å‘','å…´ä¸š','æ°‘ç”Ÿ','ä¸­ä¿¡'];
  const legals = ['å¼ ä¼Ÿ','ç‹ç£Š','æé™','åˆ˜æ´‹','é™ˆæ°','æ¨æ•','èµµå¼º','é»„èŠ³','å‘¨é¢–','å´ç£Š','éƒ‘å‡¯','å­™å©·','æœ±æ•','èƒ¡æ¶›','éƒ­å¼º','ä½•å†›','é«˜ç£Š','ç½—æ•','æ¢æ°','å®‹ä¼Ÿ'];
  const rels = ['å®¢æˆ·','ä¾›åº”å•†','å‘˜å·¥','å…¶ä»–'];

  const N = 220; // æ›´å¤šæ•°æ®
  const companies = Array.from({length:N},(_,i)=>{
    const foundedDays = Math.floor(Math.random()*3650)+60; // 2ä¸ªæœˆ~10å¹´
    const employees = Math.floor(Math.random()*150);
    const inflow = +(Math.random()*1500+30).toFixed(1);   // ä¸‡
    const outflow= +(Math.random()*1300+20).toFixed(1);   // ä¸‡
    const txCnt  = Math.floor(Math.random()*120)+2;
    const total  = +(inflow+outflow).toFixed(1);
    const recognized = Math.random()>0.3;
    const date = new Date(Date.now()-foundedDays*86400000);
    const dstr = `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
    const name = `${randPick(companyPrefixes)}${randPick(companyMains)}${randPick(companySuffixes)}`
    return {
      id:i+1,
      name,
      inflow, outflow, total, txCnt,
      rel: randPick(rels),
      bank: randPick(banks),
      recognized,
      foundedDays, foundedDate:dstr,
      capital: Math.floor(Math.random()*10000)+100, // ä¸‡
      legal: randPick(legals),
      status: Math.random()>0.08 ? 'å­˜ç»­' : (Math.random()>0.5 ? 'åœ¨ä¸š' : 'æ³¨é”€'),
      lawsuits: Math.floor(Math.random()*8),
      dishonesty: Math.floor(Math.random()*4),
      employees,
      type: (Math.random()>0.72 ? (Math.random()>0.5?'ä¸ªäºº':'ä¸ªä½“å·¥å•†æˆ·') : 'å…¬å¸'),

      // æ–°å¢å­—æ®µ
      blacklist: Math.random()>0.8 ? 'æ˜¯' : 'å¦',
      ctype: ['å®¢æˆ·','ä¾›åº”å•†','å‘˜å·¥'][i%3],
      relation: ['æ¯å­å…¬å¸','åŒè‚¡ä¸œ','ä¸Šä¸‹æ¸¸'][i%3],
      sales: ['åŸæ–™','æˆå“','æœåŠ¡'][i%3],
      purchase: ['åŸæ–™','æˆå“','æœåŠ¡'][2-i%3],
      job: ['æ€»ç»ç†','è´¢åŠ¡','å‘˜å·¥'][i%3],
      note: 'å¤‡æ³¨' + (i+1),
      startDate: '2019-01-01',
      endDate: '2029-12-31',
      term: '20å¹´',
      industry: ['åˆ¶é€ ä¸š','æœåŠ¡ä¸š','é›¶å”®ä¸š'][i%3],
      scope: 'ä¸»è¥ä¸šåŠ¡èŒƒå›´æè¿°',
      addr: 'æŸå¸‚æŸåŒºæŸè·¯',
      contact: '010-88888888',
      directors: 'å¼ ä¸‰/æå››/ç‹äº”'
    }
  });

    /* =============== é¡¶éƒ¨ç­›é€‰ä¸‹æ‹‰ï¼šå¤–ç½®å¹¶å¡«å……é€‰é¡¹ =============== */
    const auditedCompanies = [
      'è¢«å®¡è®¡å•ä½Aé›†å›¢æœ‰é™å…¬å¸','è¢«å®¡è®¡å•ä½Bç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸','è¢«å®¡è®¡å•ä½Cå®ä¸šå‘å±•æœ‰é™å…¬å¸','è¢«å®¡è®¡å•ä½Dä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸'
    ];
    function initFilters(){
      const fCompany=document.getElementById('fCompany');
      const fBank=document.getElementById('fBank');
      const fFunc=document.getElementById('fFunc');
      fCompany.innerHTML = ['<option value="all">å…¨éƒ¨</option>',...auditedCompanies.map(x=>`<option>${x}</option>`)].join('');
      const bankOpts = ['å…¨éƒ¨',...new Set(companies.map(x=>x.bank))];
      fBank.innerHTML = bankOpts.map(x=>`<option>${x}</option>`).join('');
      fFunc.innerHTML = ['å…¨éƒ¨',...funcs].map(x=>`<option>${x}</option>`).join('');
    }
    initFilters();

    // é¡¶éƒ¨ tab åˆ‡æ¢
    const TAB_INTROS = {
      account:"æœ¬é¡µä¸ºç”¨æˆ·æä¾›èµ„é‡‘æ€»è§ˆã€è´¦æˆ·äº¤æ˜“æŒ‰æœˆåˆ†å¸ƒã€ç¼ºå¤±åŒåè´¦æˆ·ä¸‰å¤§åŠŸèƒ½æ¨¡å—ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·å…¨é¢äº†è§£å·²ä¸Šä¼ å¹¶æ‰§è¡Œåˆ†æçš„é“¶è¡Œæµæ°´çš„èµ„é‡‘è§„æ¨¡ã€å„é“¶è¡Œè´¦å·äº¤æ˜“åˆ†å¸ƒæƒ…å†µï¼ŒåŒæ—¶è¯†åˆ«å‡ºæœªè·å–æµæ°´çš„é“¶è¡Œè´¦å·ã€‚",
      biz:"æœ¬é¡µä¸ºç”¨æˆ·æä¾›å·²ä¸Šä¼ å¹¶æ‰§è¡Œåˆ†æçš„é“¶è¡Œæµæ°´çš„å¤šç»´åº¦åˆ†æï¼ŒåŒ…æ‹¬ï¼šèµ„é‡‘æµæ°´ä½™é¢ã€æµå…¥æµå‡ºè¶‹åŠ¿ã€æµå…¥æµå‡ºæ„æˆï¼Œé€šè¿‡æ—¶é—´åºåˆ—åˆ†æã€äº¤æ˜“æ€§è´¨å’Œå¯¹æ‰‹æ–¹æ€§è´¨ç­‰åˆ†æï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·è¯†åˆ«åˆ°ä¸è¢«å®¡è®¡å•ä½çš„èµ„é‡‘è§„æ¨¡ä¸è¿è¥æ¨¡å¼é¢„æœŸä¸ç¬¦çš„æƒ…å†µã€‚(æœ¬é¡µçš„æ‰€æœ‰é‡‘é¢ï¼Œå·²æŒ‰ç…§ç”¨æˆ·ä¸Šä¼ çš„æ±‡ç‡ä¸»æ¡£æˆ–ç³»ç»Ÿé»˜è®¤PBOCæ±‡ç‡è¿›è¡Œè½¬æ¢ï¼Œå‡ä»¥äººæ°‘å¸æ˜¾ç¤º)",
      relation:"æœ¬é¡µå±•ç¤ºå’Œåˆ†æï¼š(1)å…³è”æ–¹ä¸»æ¡£ä¸­çš„å¯¹æ‰‹æ–¹ï¼Œå’Œ(2)äºâ€œç»è¥å®è´¨>æµå…¥æµå‡ºæ„æˆâ€ä¸­æ‰‹å·¥æ ‡è®°ä¸ºå…³è”æ–¹çš„å¯¹æ‰‹æ–¹çš„äº¤æ˜“ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·å…¨é¢äº†è§£è¢«å®¡è®¡å•ä½ä¸å…³è”æ–¹çš„èµ„é‡‘å¾€æ¥ï¼ŒååŠ©ç”¨æˆ·è¿›è¡Œå…³è”æ–¹æŠ«éœ²ã€‚å¦‚ç”¨æˆ·æš‚æœªä¸Šä¼ å…³è”æ–¹ä¸»æ¡£æˆ–æœªæ‰‹å·¥æ‰“æ ‡ï¼Œåˆ™æœ¬é¡µå±•ç¤ºå†…å®¹ä¸ºç©ºã€‚",
      transaction:"æœ¬é¡µå±•ç¤ºå’Œåˆ†æï¼š(1)å‘˜å·¥ä¸»æ¡£ä¸­çš„å¯¹æ‰‹æ–¹ï¼Œå’Œ(2)å…¶ä»–ä¸ªäºº(å°äºæˆ–ç­‰äºå››ä¸ªå­—ç¬¦)çš„å¯¹æ‰‹æ–¹äº¤æ˜“ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·å…¨é¢äº†è§£è¢«å®¡è®¡å•ä½ä¸ä¸ªäººçš„èµ„é‡‘å¾€æ¥ï¼ŒååŠ©ç”¨æˆ·è¿›è¡Œå…³è”ä¸ªäººå’Œè‘£ç›‘é«˜çš„è¯†åˆ«ä¸æŠ«éœ²ã€ä¸ªäººäº¤æ˜“çš„åˆç†æ€§åˆ†æåŠé£é™©è¯†åˆ«ã€‚å¦‚ç”¨æˆ·æš‚æœªä¸Šä¼ å‘˜å·¥ä¸»æ¡£ï¼Œåˆ™æœ¬é¡µä»…å±•ç¤ºä¸å…¶ä»–ä¸ªäººå¯¹æ‰‹æ–¹äº¤æ˜“ã€‚",
      routine:"èšåˆå·¥å•†ä¿¡æ¯å¹¶ä¸äº¤æ˜“è§„æ¨¡è”åŠ¨æ ¡éªŒä¼ä¸šçœŸå®æ€§ä¸é£é™©ã€‚",
      statement:"ç”¨æˆ·å¯å¯¹æœ¬é¡µçš„å¤šç»´ç­›é€‰å™¨è®¾ç½®ç­›é€‰æ¡ä»¶ï¼Œç³»ç»Ÿå°†åœ¨å·²ä¸Šä¼ å¹¶æ‰§è¡Œåˆ†æçš„é“¶è¡Œæµæ°´ä¸­é€‰å‡ºç¬¦åˆç­›é€‰æ¡ä»¶çš„å¼‚å¸¸äº¤æ˜“æµæ°´ï¼Œå¹¶æ”¯æŒæµæ°´å¯¼å‡ºï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·æ ¹æ®é¡¹ç›®éœ€æ±‚ï¼Œå…¨é¢ã€å¿«é€Ÿã€ç²¾å‡†åœ°ç­›é€‰å‡ºå¼‚å¸¸é“¶è¡Œæµæ°´ï¼ŒååŠ©ç”¨æˆ·è¿›ä¸€æ­¥æ‰§è¡Œå®¡è®¡ç¨‹åºã€‚",
      verify:"æœ¬é¡µæ±‡æ€»å·²ä¸Šä¼ å¹¶æ‰§è¡Œåˆ†æçš„ç”µå­é“¶è¡Œæµæ°´çš„æœŸåˆé‡‘é¢ã€å€Ÿæ–¹å‘ç”Ÿé¢ã€è´·æ–¹å‘ç”Ÿé¢åŠæœŸæœ«ä½™é¢ï¼Œå¹¶å°†å…¶ä¸ä¸Šä¼ çš„é“¶è¡Œç§‘ç›®æ€»è´¦/åˆ†è´¦å·ä½™é¢è¡¨è¿›è¡Œæ¯”å¯¹ï¼Œå¹¶å±•ç¤ºä¸¤è€…å·®å¼‚ï¼ŒååŠ©ç”¨æˆ·å®Œæˆé“¶è¡Œæµæ°´çš„å®Œæ•´æ€§æµ‹è¯•ã€‚"
    };
    
    function setTabIntro(key){
      const el = document.getElementById('tabIntro');
      if(!el) return;
      el.innerHTML = `
        <svg class="ti-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M12 2a10 10 0 1 0 .001 20.001A10 10 0 0 0 12 2Zm0 14a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm1-9h-2a1 1 0 0 0-1 1v1h2v6h2V8a2 2 0 0 0-2-2Z"/>
        </svg>
        <div><span class="ti-title">é¡µé¢è¯´æ˜ï¼š</span>${TAB_INTROS[key]||''}</div>`;
    }
    
    function moveInkbar(activeEl){
      const bar  = document.getElementById('inkbar');
      const wrap = document.getElementById('topTabs'); // æ»šåŠ¨å®¹å™¨
      if(!bar || !wrap || !activeEl) return;
    
      const rWrap = wrap.getBoundingClientRect();
      const rTab  = activeEl.getBoundingClientRect();
    
      const left = (rTab.left - rWrap.left) + wrap.scrollLeft;
      bar.style.left  = left + 'px';
      bar.style.width = rTab.width + 'px';
    }
    
    // ç»‘å®š
    function bindTabs(){
      document.querySelectorAll('#topTabs .tab').forEach(tab=>{
        tab.addEventListener('click', ()=>{
          document.querySelectorAll('#topTabs .tab').forEach(t=>t.classList.remove('active'));
          tab.classList.add('active');
    
          const key = tab.dataset.top;
          document.querySelectorAll('.tab-pane').forEach(p=>p.classList.remove('active'));
          document.getElementById('pane-'+key)?.classList.add('active');
    
          setTabIntro(key);
          // ä¸‹ä¸€å¸§å†è®¡ç®—ï¼Œé¿å…å¸ƒå±€è¿˜æœªå®Œæˆ
          requestAnimationFrame(()=>moveInkbar(tab));
        });
      });
    
      // æ¨ªå‘æ»šåŠ¨æ—¶ä¹Ÿè¦æ›´æ–° inkbar
      const wrap = document.getElementById('topTabs');
      wrap?.addEventListener('scroll', ()=>{
        const active = document.querySelector('#topTabs .tab.active');
        if(active) moveInkbar(active);
      }, { passive:true });
    }
    
    document.addEventListener('DOMContentLoaded', ()=>{
      bindTabs();
      const active = document.querySelector('#topTabs .tab.active') || document.querySelector('#topTabs .tab');
      if(active) {
        setTabIntro(active.dataset.top);
        // å­—ä½“/æ»šåŠ¨æ¡æ¸²æŸ“åå†å®šä½
        requestAnimationFrame(()=>moveInkbar(active));
      }
    });
    window.addEventListener('resize', ()=>{
      const active = document.querySelector('#topTabs .tab.active');
      if(active) moveInkbar(active);
    });
    
     //è´¦æˆ·æ€»è§ˆå±•å¼€æ”¶èµ·
    document.addEventListener("DOMContentLoaded",()=>{
      const scope=document.getElementById('checkScope');
      const btn=document.getElementById('btnToggleCheck');
      if(!scope||!btn)return;
      const setExpand=(expand)=>{
        scope.classList.toggle('expanded',expand);
        btn.classList.toggle('expanded',expand);
      };
      setExpand(false);
      btn.addEventListener('click',()=>{setExpand(!scope.classList.contains('expanded'));});
    });
     
    //ç¼ºå¤±åŒåè´¦æˆ·å…¬å¸ä¸‹æ‹‰
    document.addEventListener('DOMContentLoaded',()=>{
      const groups = document.querySelectorAll('#tblMissingSameName .group-row');
      groups.forEach(row=>{
        const btn = row.querySelector('.expand-btn');
        const groupId = row.dataset.group;
        // é»˜è®¤å±•å¼€ï¼šdetail-row å·²æ˜¾ç¤º
        btn.addEventListener('click',()=>{
          const expanded = btn.classList.toggle('expanded');
          document.querySelectorAll(`.group-${groupId}`).forEach(d=>{
            d.style.display = expanded ? 'table-row' : 'none';
          });
          btn.textContent = expanded ? 'â–¼' : 'â–¶';
        });
      });
    });

      
    /* =============== ç»è¥å®è´¨ï¼šå›¾è¡¨ =============== */
    /* =============== ç»è¥å®è´¨ï¼šé€šç”¨ï¼ˆæ—¥ç²’åº¦ï¼‰ =============== */
    /* 1) ç”Ÿæˆ 2023-01-01 ~ 2024-12-31 çš„æ¯æ—¥æ—¥æœŸ */
    function genDays(start, end){
      const out = [];
      const s = new Date(start), e = new Date(end);
      for(let d=new Date(s); d<=e; d.setDate(d.getDate()+1)){
        out.push(d.toISOString().slice(0,10)); // YYYY-MM-DD
      }
      return out;
    }
    const days = genDays('2023-01-01','2024-12-31'); // å…± 731 å¤©ï¼ˆå«é—°å¹´ 2024ï¼‰
    
    /* 2) ç”Ÿæˆâ€œå°–å³°å‹â€æ—¥çº§ç¤ºä¾‹æ•°æ®ï¼ˆæ¥å…¥çœŸå®æ•°æ®æ—¶æ›¿æ¢ dataInDaily / dataOutDailyï¼‰ */
    function genSpikyDaily(len, baseMin, baseMax, spikeProb=0.06, spikeMin=6e6, spikeMax=8e7){
      return Array.from({length: len}, (_,i)=>{
        // å°é¢åŸºçº¿ + è½»å¾®æ³¢åŠ¨
        const base = baseMin + Math.random()*(baseMax-baseMin);
        const wave = Math.sin(i/13)*0.15*base + Math.cos(i/29)*0.1*base;
        let v = Math.max(0, base + wave);
    
        // ä»¥å°æ¦‚ç‡äº§ç”Ÿå¤§é¢å°–å³°
        if (Math.random() < spikeProb){
          v += spikeMin + Math.random()*(spikeMax-spikeMin);
        }
        return Math.round(v);
      });
    }
    const dataInDaily  = genSpikyDaily(days.length, 1.2e5, 9e5, 0.05, 2e6, 6e7);  // æ—¥æµå…¥
    const dataOutDaily = genSpikyDaily(days.length, 1.0e5, 8e5, 0.05, 2e6, 5e7);  // æ—¥æµå‡º
    
    /* 3) å·¥å…·å‡½æ•° */
    function sum(a){return a.reduce((s,x)=>s+x,0)}
    function avg(a){return a.length? (sum(a)/a.length):0}
    function fmt(n){return n.toLocaleString('zh-CN')}
    const fmtK = n => (n||0).toLocaleString('zh-CN');
    
    function pickByYearDays(year, arr){   // ä»æ—¥çº§æ•°ç»„ä¸­æˆªå–å¹´æ®µ
      if (year==='2023'){
        return arr.slice(0, 365);
      }
      if (year==='2024'){
        return arr.slice(365);
      }
      return arr; // 2023-2024
    }
    function pickDaysX(year){             // å–å¯¹åº”çš„ X è½´ï¼ˆæ—¥æœŸï¼‰
      if (year==='2023') return days.slice(0,365);
      if (year==='2024') return days.slice(365);
      return days;
    }
    
    const palette = {
      blue:  '#2152ff',
      blueA: 'rgba(33,82,255,0.14)',
      red:   '#E64646',
      redA:  'rgba(230,70,70,0.10)',
      axis:  '#cbd5e1',
      text:  '#334155',
      grid:  '#e9eef7'
    };
    function baseGrid(){ return { left: 56, right: 16, top: 28, bottom: 56, containLabel: true }; }
    function baseDataZoom(){
      return [
        { type:'inside', zoomOnMouseWheel:false, moveOnMouseWheel:true, moveOnMouseMove:true },
        { type:'slider', height:14, bottom:12, handleSize:0, borderColor:'#dfe6f2',
          backgroundColor:'#f1f5f9', fillerColor:'rgba(30,73,226,.12)' }
      ];
    }
    function baseAxis(xCats){
      return {
        xAxis: { type:'category', data:xCats, boundaryGap:false,
          axisLine:{lineStyle:{color:palette.axis}}, axisLabel:{color:palette.text, margin:10},
          axisTick:{show:false}, splitLine:{show:false}
        },
        yAxis: { type:'value', axisLine:{show:false},
          axisLabel:{color:palette.text, formatter: v=>fmtK(v)},
          splitLine:{show:true, lineStyle:{color:palette.grid}}
        }
      };
    }
    function baseTooltip(formatter){
      return {
        trigger:'axis', confine:true, className:'echarts-tip', borderWidth:0,
        backgroundColor:'transparent', padding:0,
        axisPointer:{type:'line', lineStyle:{color:'#94a3b8', type:'dashed'}},
        formatter
      };
    }
    function makeLineChart(domId, opt){
      const chart = echarts.init(document.getElementById(domId));
      chart.setOption(opt, true);
      window.addEventListener('resize', ()=>chart.resize());
      return chart;
    }
    
    /* ========= èµ„é‡‘æµæ°´ä½™é¢ï¼šå•è“çº¿ï¼ˆé˜¶æ¢¯ï¼‰+ è§’æ ‡ + ç¼©æ”¾ ========= */
    function renderBalance(){
      const y    = document.getElementById('yearBalance')?.value || '2023-2024';
      const xSel = pickDaysX(y);
    
      // ç”¨â€œæ—¥æµå…¥-æ—¥æµå‡ºâ€çš„ç´¯è®¡è¿‘ä¼¼ä½™é¢ï¼ˆ>0 çº¦æŸï¼‰ï¼›å¦‚æœ‰çœŸå®ä½™é¢ï¼Œæ›¿æ¢ balanceData/xSel å³å¯
      const inSel  = pickByYearDays(y, dataInDaily);
      const outSel = pickByYearDays(y, dataOutDaily);
      let acc = 0;
      const balanceData = inSel.map((v,i)=>{
        acc = Math.max(0, acc + v - (outSel[i] || 0));   // â† ä¸å…è®¸ä¸ºè´Ÿ
        return acc;
      });
      const lastBal = balanceData.length ? balanceData[balanceData.length-1] : 0;
    
      makeLineChart('chart-balance', {
        color: [palette.blue],                                  // å›ºå®šè°ƒè‰²
        grid:  baseGrid(),
        ...baseAxis(xSel),
        dataZoom: baseDataZoom(),
        tooltip: baseTooltip(p=>{
          const v = p[0]?.value ?? 0;
          return `
            <div class="tip-card">
              <div class="t">${p[0].axisValue}</div>
              <div class="tip-row"><span class="tip-k">ä½™é¢</span><span class="tip-v">Â¥ ${fmtK(v)}</span></div>
            </div>`;
        }),
        // å³ä¸Šè§’â€œä½™é¢è§’æ ‡â€
        /* âœ… è¿™é‡Œæ–°å¢ legend */
        legend: {
          top: 6,
          right: 10,
          icon: 'roundRect',
          itemWidth: 12,
          itemHeight: 12,
          textStyle:{ color:'#475569' }
        },
        xAxis: { ...baseAxis(xSel).xAxis, boundaryGap: false },
        yAxis: { ...baseAxis(xSel).yAxis, min: 0 },             // y è½´ä» 0 å¼€å§‹
        series: [{
          name:'ä½™é¢',
          type:'line',
          step: 'middle',                                       // â† é˜¶æ¢¯çº¿ï¼Œæ›´åƒä½™é¢å˜åŒ–
          smooth:false,
          sampling:'lttb',
          showSymbol:false,
          connectNulls:true,
          lineStyle:{ width: 2.4, color: palette.blue },
          areaStyle:{
            color: new echarts.graphic.LinearGradient(0,0,0,1,[
              {offset:0, color: palette.blueA},
              {offset:1, color:'rgba(33,82,255,0)'}
            ])
          },
          data: balanceData
        }]
      });
    }
    
    /* ========= æµå…¥æµå‡ºè¶‹åŠ¿ï¼šè“/çº¢åŒçº¿ + ç¼©æ”¾ï¼ˆæ— é¢ç§¯ï¼‰ ========= */
    function renderIO(){
      const y    = document.getElementById('yearIO')?.value || '2023-2024';
      const xSel = pickDaysX(y);
      const inSel  = pickByYearDays(y, dataInDaily);
      const outSel = pickByYearDays(y, dataOutDaily);
    
      // KPIï¼ˆæ²¿ç”¨ï¼‰
      const $ = id => document.getElementById(id);
      if ($('io_in_sum'))  $('io_in_sum').textContent  = 'Â¥' + fmt(sum(inSel));
      if ($('io_in_avg'))  $('io_in_avg').textContent  = 'Â¥' + fmt(Math.round(avg(inSel)));
      if ($('io_out_sum')) $('io_out_sum').textContent = 'Â¥' + fmt(sum(outSel));
      if ($('io_out_avg')) $('io_out_avg').textContent = 'Â¥' + fmt(Math.round(avg(outSel)));
    
      makeLineChart('chart-io', {
        color: [palette.blue, palette.red],                     // â† å¼ºåˆ¶â€œæµå…¥è“ / æµå‡ºçº¢â€
        grid:  baseGrid(),
        ...baseAxis(xSel),
        legend:{ top:6, right:8, icon:'roundRect', itemWidth:10, itemHeight:10,
          textStyle:{ color: palette.text } },
        dataZoom: baseDataZoom(),
        tooltip: baseTooltip(params=>{
          const pin  = params.find(p=>p.seriesName==='æµå…¥');
          const pout = params.find(p=>p.seriesName==='æµå‡º');
          return `
            <div class="tip-card">
              <div class="t">${params[0].axisValue}</div>
              <div class="tip-row"><span class="tip-k">æµå…¥</span><span class="tip-v" style="color:${palette.blue}">Â¥ ${fmtK(pin?.value||0)}</span></div>
              <div class="tip-row"><span class="tip-k">æµå‡º</span><span class="tip-v" style="color:${palette.red}">Â¥ ${fmtK(pout?.value||0)}</span></div>
            </div>`;
        }),
        xAxis: { ...baseAxis(xSel).xAxis, boundaryGap: false },
        yAxis: { ...baseAxis(xSel).yAxis, min: 0 },             // ä» 0 èµ·ï¼Œæ›´ç›´è§‚
        series: [
          { name:'æµå…¥', type:'line', smooth:false, sampling:'lttb', showSymbol:false, connectNulls:true,
            lineStyle:{ width:2, color: palette.blue }, data: inSel },
          { name:'æµå‡º', type:'line', smooth:false, sampling:'lttb', showSymbol:false, connectNulls:true,
            lineStyle:{ width:2, color: palette.red  }, data: outSel }
        ]
      });
    }
    
    /* é¦–æ¬¡æ¸²æŸ“ & è”åŠ¨ï¼ˆä¿æŒä¸å˜ï¼‰ */
    renderBalance();
    renderIO();
    document.getElementById('yearBalance')?.addEventListener('change', renderBalance);
    document.getElementById('yearIO')?.addEventListener('change', renderIO);


    /* ===== ä¾èµ–ä¸å ä½ï¼ˆè‹¥ä½ é¡¹ç›®é‡Œå·²æœ‰ months / dataIn / dataOut / ez å°±ä¼šè‡ªåŠ¨å¤ç”¨ï¼‰ ===== */
    const C_BLUE='#2152ff', C_RED='#E64646';
    if(typeof window.months==='undefined'){
      window.months=[...Array.from({length:12},(_,i)=>`2023-${String(i+1).padStart(2,'0')}`),
                     ...Array.from({length:12},(_,i)=>`2024-${String(i+1).padStart(2,'0')}`)];
    }
    if(typeof window.dataIn==='undefined' || typeof window.dataOut==='undefined'){
      window.dataIn = months.map(()=>Math.round(2e6+Math.random()*8e6));
      window.dataOut= months.map(()=>Math.round(1.5e6+Math.random()*7e6));
    }
    if(typeof window.ez==='undefined'){
      window.ez=function(domId,opt){const el=document.getElementById(domId);
        const inst=echarts.getInstanceByDom(el)||echarts.init(el);inst.setOption(opt,true);return inst;}
    }
    const yFmt=v=>(v||0).toLocaleString('zh-CN');
    
    /* ===== 7 ç±»å æ¯”ï¼ˆå¯æ¥çœŸå®å€¼ï¼‰ ===== */
    const categories=['å…¨ä½“å¯¹æ‰‹æ–¹','å·²çŸ¥å…³è”æ–¹','ä¾›åº”å•†','å®¢æˆ·','å‘˜å·¥','å…¶ä»–','ä¸ªäºº'];
    function renderCompCats(){
      const nums=[100,28,0,0,0,0,0]; // TODO: æ›¿æ¢æˆä½ çš„çœŸå®ç»Ÿè®¡
      const total=nums.reduce((s,x)=>s+x,0)||1;
      const wrap=document.getElementById('compCats'); if(!wrap) return;
      wrap.innerHTML=categories.map((n,i)=>`
        <div class="cat">
          <div class="name">${n}</div>
          <div class="pct">${(nums[i]/total*100).toFixed(2)}%</div>
        </div>`).join('');
    }
    
    /* ===== æœˆåº¦åˆ†å¸ƒï¼ˆäº¤æ˜“æ€»é¢ / æµå…¥æ–¹ / æµå‡ºæ–¹ï¼‰â€”â€”å›¾äºŒæ ·å¼è“çº¢æŸ±çŠ¶ ===== */
    function renderCompCharts(mode='total'){
      if(!document.getElementById('chart-comp-monthly')) return;
      let series=[];
      if(mode==='in'){
        series=[{name:'æµå…¥',type:'bar',barWidth:16,itemStyle:{color:C_BLUE},data:dataIn}];
      }else if(mode==='out'){
        series=[{name:'æµå‡º',type:'bar',barWidth:16,itemStyle:{color:C_RED},data:dataOut}];
      }else{
        series=[
          {name:'æµå…¥',type:'bar',barWidth:16,itemStyle:{color:C_BLUE},data:dataIn},
          {name:'æµå‡º',type:'bar',barWidth:16,itemStyle:{color:C_RED}, data:dataOut}
        ];
      }
      ez('chart-comp-monthly',{
        grid:{left:56,right:16,top:30,bottom:40,containLabel:true},
        color:[C_BLUE,C_RED],
        legend:{top:6,right:8,icon:'roundRect',itemWidth:10,itemHeight:10},
        tooltip:{trigger:'axis',axisPointer:{type:'shadow'},valueFormatter:yFmt},
        xAxis:{type:'category',data:months,axisTick:{show:false}},
        yAxis:{type:'value',axisTick:{show:false},splitLine:{lineStyle:{color:'#eef2f7'}},axisLabel:{formatter:yFmt}},
        series
      });
    
      // â€”â€” Top20ï¼ˆå³ä¾§åˆ—è¡¨ï¼Œå›¾ä¸€é£æ ¼ï¼‰ã€‚è¿™é‡Œæ¼”ç¤ºç”¨å ä½ï¼Œæ¥ä½ çœŸå®èšåˆå³å¯ã€‚
      const list = Array.from({length:10},(_,i)=>({
        name:['abcæœ‰é™å…¬å¸','a****æ–°èƒ½æºæ±½è½¦æŠ€æœ¯æœ‰é™å…¬å¸','w**è‚¡ä»½æœ‰é™å…¬å¸','b****æ±½è½¦éƒ¨ä»¶æœ‰é™å…¬å¸',
              'k****æ±½è½¦ç”µå­é›¶éƒ¨ä»¶æœ‰é™å…¬å¸','o3****é‡‘å±å¡‘æ–™åˆ¶å“å‚','p****é›†å›¢è‚¡ä»½æœ‰é™å…¬å¸å‹Ÿé›†åˆèµ„ä¸“æˆ·',
              'h****motivesystemsholdingco.ltd','l****æ±½è½¦é›¶éƒ¨ä»¶æœ‰é™å…¬å¸','x****ææ–™ç§‘æŠ€æœ‰é™å…¬å¸'][i] || `å¯¹æ‰‹æ–¹ ${i+1}`,
        amount:Math.round(2e7+Math.random()*5e8)
      })).sort((a,b)=>b.amount-a.amount);
      renderTop20Panel(list);
    }
    
    // ç»Ÿä¸€é‡‘é¢æ ¼å¼
    function fmtCNY(n){ return `Â¥${(Number(n)||0).toLocaleString('zh-CN')}`; }
    
    /* ===== Top20 åˆ—è¡¨æ¸²æŸ“ï¼šæ ‡é¢˜ = â€œTop20 äº¤æ˜“æ€»é¢â€ ===== */
    function renderTop20Panel(list){
      const box = document.getElementById('chart-comp-top20');
      if(!box) return;
    
      // å¦‚æœè¿™ä¸ªå®¹å™¨ä¹‹å‰è¢« ECharts ä½¿ç”¨è¿‡ï¼Œå…ˆé‡Šæ”¾ï¼Œé¿å…è¦†ç›–
      const old = echarts.getInstanceByDom(box);
      if(old) old.dispose();
    
      // å…è®¸ä¼ ç©ºä½¿ç”¨å¤–éƒ¨å ä½
      list = Array.isArray(list) ? list : (window.__top20List || []);
      const total = list.reduce((s,x)=>s + (Number(x.amount)||0), 0);
    
      box.innerHTML = `
        <div class="top20-card">
          <div class="top20-head">
            <div>
              <span class="top20-title">Top20 äº¤æ˜“æ€»é¢</span>
              <span class="top20-sub">å æ¯”å¯æ›¿æ¢ä¸ºçœŸå®å€¼</span>
            </div>
            <div class="top20-total">${fmtCNY(total)}</div>
          </div>
    
          <div class="top20-list">
            ${list.map((row,idx)=>`
              <div class="top20-row">
                <div class="rank-badge ${idx===0?'top1':idx===1?'top2':idx===2?'top3':''}">${idx+1}</div>
                <div class="cp-name" title="${row.name}">${row.name}</div>
                <div class="cp-amt">${fmtCNY(row.amount)}</div>
              </div>
            `).join('')}
          </div>
        </div>`;
    }
    
    /* ===== Tab åˆ‡æ¢ ===== */
    document.getElementById('compTabs')?.addEventListener('click',e=>{
      const tab=e.target.closest('.tab'); if(!tab) return;
      document.querySelectorAll('#compTabs .tab').forEach(t=>t.classList.remove('active'));
      tab.classList.add('active');
      renderCompCharts(tab.dataset.mode); // total | in | out
    });
    
    /* ===== åˆå§‹åŒ– ===== */
    renderCompCats();
    renderCompCharts('total');


    
    /* =============== ä½ åŸæœ‰çš„è¡¨æ ¼åˆ†é¡µä¸å¡«å……ï¼ˆä¸æ”¹åŠ¨ç»“æ„ï¼‰ =============== */
    let currentPageDeal=1, currentPageCorp=1, currentRoutinePage=1;
    const pageSize=10;
    let bizFilteredList = companies.slice(); // ç»è¥å®è´¨åŒºåŸŸå½“å‰ç­›é€‰ç»“æœ
    
    function paginate(arr,page){return arr.slice((page-1)*pageSize,page*pageSize);}
    function renderPagination(eleId,total,current,handler){
      const pages=Math.max(1,Math.ceil(total/pageSize));
      let html='';
      for(let i=1;i<=pages;i++){
        html+=`<button class="btn ${i===current?'btn-primary':''}" onclick="${handler}(${i})">${i}</button>`;
      }
      document.getElementById(eleId).innerHTML=html;
    }
    
    function toggleSb(li){
      li.classList.toggle('open');
      const submenu = li.querySelector('.sb-submenu');
      if (submenu) submenu.classList.toggle('show');
    }
    
    /* ä¸¤å¼ è¡¨ */
    function fillBizTables(list=bizFilteredList){
      const totalSum = list.reduce((s,x)=>s+x.total,0)||1;
    
      // äº¤æ˜“æ˜ç»†
      const dealPage=paginate(list,currentPageDeal);
      document.querySelector('#tblDeal tbody').innerHTML = dealPage.map(r=>`
        <tr>
          <td>${r.name}</td>
          <td>${r.ctype}</td><td>${r.relation}</td>
          <td>${r.blacklist}</td>
          <td style="color:#2563eb">${fmtWan(r.inflow)}</td>
          <td style="color:#ef4444">${fmtWan(r.outflow)}</td>
          <td><b>${fmtWan(r.total)}</b></td>
          <td>${(r.total/totalSum*100).toFixed(2)}%</td>
          <td>${r.txCnt}</td>
          <td>${r.sales}</td><td>${r.purchase}</td><td>${r.job}</td>
          <td>${r.note}</td>
          <td><button class="btn">æŸ¥çœ‹è¯¦æƒ…</button></td>
        </tr>`).join('');
      renderPagination('pagination-deal',list.length,currentPageDeal,'gotoDeal');
    
      // å·¥å•†ä¿¡æ¯
      const corpPage=paginate(list,currentPageCorp);
      document.querySelector('#tblCorp tbody').innerHTML = corpPage.map(r=>`
        <tr>
          <td>${r.name}</td><td><b>${fmtWan(r.total)}</b></td>
          <td>${r.foundedDate}</td><td>${r.startDate}</td><td>${r.endDate}</td>
          <td>${r.term}</td><td>${r.status}</td><td>${r.capital}</td>
          <td>${r.industry}</td><td>${r.scope}</td><td>${r.addr}</td>
          <td>${r.contact}</td><td>${r.directors}</td>
        </tr>`).join('');
      renderPagination('pagination-corp',list.length,currentPageCorp,'gotoCorp');
    }
    function gotoDeal(p){currentPageDeal=p;fillBizTables()}
    function gotoCorp(p){currentPageCorp=p;fillBizTables()}
    
    // ================== åˆ·æ–°åè®°å¿†ï¼šé¡¶å±‚ Tab & å­è¡¨ Tab ==================
    /* ================== åˆ·æ–°è®°å¿†çš„ key ================== */
    const STORAGE_KEYS = {
      topTab:  'topTab.active',   // é¡¶éƒ¨ï¼šaccount/biz/...
      listTab: 'biz.listTab'      // å­è¡¨ï¼šdeal/corp
    };
    
    /* ================== æƒ°æ€§æ¸²æŸ“å¼€å…³ ================== */
    let __dealInited = false;
    let __corpInited = false;
    
    /* è‹¥å¤–éƒ¨å·²å‡†å¤‡å¥½ companies / bizFilteredListï¼Œåˆ™å¤ç”¨ */
    window.bizFilteredList = window.bizFilteredList || (window.companies ? companies.slice() : []);
    
    /* ================== æ¸²æŸ“å‡½æ•°ï¼ˆå¤ç”¨ä½ è‡ªå·±çš„ï¼‰ ================== */
    function renderDealOnce(){
      if (__dealInited) return;
      __dealInited = true;
      if (typeof fillBizTables === 'function') fillBizTables();
    }
    function renderCorpOnce(){
      if (__corpInited) return;
      __corpInited = true;
      if (typeof fillBizTables === 'function') fillBizTables();
    }
    
    /* ================== inkbar åŒæ­¥ï¼ˆå¯é€‰ï¼‰ ================== */
    function updateInkbar(){
      const bar  = document.getElementById('inkbar');
      const tabs = document.getElementById('topTabs');
      if (!bar || !tabs) return;
      const act = tabs.querySelector('.tab.active');
      if (!act) return;
      const rb = tabs.getBoundingClientRect();
      const ra = act.getBoundingClientRect();
      bar.style.left  = (ra.left - rb.left + tabs.scrollLeft) + 'px';
      bar.style.width = ra.width + 'px';
    }
    
    /* ================== å­è¡¨åˆ‡æ¢ï¼ˆç»Ÿä¸€å…¥å£ï¼‰ ================== */
    function switchSubTable(view){ // 'deal' | 'corp'
      const showDeal = view === 'deal';
      const dealWrap = document.getElementById('tbl-deal-wrap');
      const corpWrap = document.getElementById('tbl-corp-wrap');
    
      dealWrap?.classList.toggle('hide', !showDeal);
      corpWrap?.classList.toggle('hide',  showDeal);
    
      // è®°å¿†å½“å‰å­è¡¨
      sessionStorage.setItem(STORAGE_KEYS.listTab, view);
    
      // æƒ°æ€§æ¸²æŸ“ä¸€æ¬¡ï¼ˆä¸é‡ç½®ç­›é€‰ï¼‰
      if (showDeal) renderDealOnce(); else renderCorpOnce();
    
      // åŒæ­¥è€ tabsï¼ˆ#listTabsï¼‰
      const listTabs = document.getElementById('listTabs');
      if (listTabs){
        listTabs.querySelectorAll('.table-tab').forEach(x=>{
          x.classList.toggle('active', x.dataset.view === view);
        });
      }
    
      // åŒæ­¥æ–°åˆ‡æ¢æ¡ï¼ˆ#tblSwitcherï¼‰
      const switcher = document.getElementById('tblSwitcher');
      if (switcher){
        switcher.querySelectorAll('.opt').forEach(x=>{
          const on = x.dataset.view === view;
          x.classList.toggle('active', on);
          x.setAttribute('aria-selected', on ? 'true' : 'false');
        });
      }
    
      // è¡¨æ ¼å¯èƒ½éœ€è¦é‡ç®—åˆ—å®½
      setTimeout(()=>window.dispatchEvent(new Event('resize')), 0);
    }
    
    /* ================== ç»è¥å®è´¨é¡µæ˜¾ç¤ºï¼šæŒ‰è®°å¿†æ¢å¤å­è¡¨å¹¶ç«‹å³æ¸²æŸ“ ================== */
    function onBizPageShown(){
      const saved = sessionStorage.getItem(STORAGE_KEYS.listTab);
      switchSubTable(saved === 'corp' ? 'corp' : 'deal');  // é»˜è®¤ deal
    }
    
    /* ================== æ—§çš„é¡¶éƒ¨å­è¡¨ Tabï¼ˆä¿ç•™å…¼å®¹ï¼‰ ================== */
    (function initListTabs(){
      const listTabs = document.getElementById('listTabs');
      if (!listTabs) return;
      listTabs.addEventListener('click', e=>{
        const tab = e.target.closest('.table-tab'); if(!tab) return;
        switchSubTable(tab.dataset.view === 'corp' ? 'corp' : 'deal');
      });
    })();
    
    /* ================== æ–°çš„å³ä¾§â€œå·¦å³åˆ‡æ¢æ¡â€ï¼ˆä¿ç•™å…¼å®¹ï¼‰ ================== */
    (function initSwitcher(){
      const wrap = document.getElementById('tblSwitcher');
      if (!wrap) return;
      wrap.addEventListener('click', e=>{
        const btn = e.target.closest('.opt'); if(!btn) return;
    
        // å¦‚éœ€åˆ‡æ¢æ—¶é‡ç½®ç­›é€‰ï¼Œæ”¾å¼€ä¸‹é¢ä¸¤è¡Œï¼›å¦åˆ™ä¿æŒå½“å‰ç­›é€‰çŠ¶æ€
        // const sel = document.getElementById('fType'); if (sel) sel.selectedIndex = 0;
        // window.bizFilteredList = (window.companies || []).slice();
    
        // ä½ è‹¥å¸Œæœ›åˆ‡æ¢æ—¶å¼ºåˆ¶åˆ·æ–°ï¼Œä¹Ÿå¯ä¿ç•™è¿™å¥ï¼ˆå¯åˆ ï¼‰
        if (typeof window.fillBizTables === 'function') window.fillBizTables();
    
        switchSubTable(btn.dataset.view === 'corp' ? 'corp' : 'deal');
      });
    })();
    
    /* ================== é¡¶éƒ¨é¡µé¢åˆ‡æ¢ï¼ˆå¸¦è®°å¿† + é¦–æ¬¡æ¢å¤ï¼‰ ================== */
    (function initTopTabs(){
      const topTabs = document.getElementById('topTabs');
      if (!topTabs) return;
    
      function showPane(key){
        document.getElementById('page-account')    ?.classList.toggle('hide', key !== 'account');
        document.getElementById('page-biz')        ?.classList.toggle('hide', key !== 'biz');
        document.getElementById('page-relation')   ?.classList.toggle('hide', key !== 'relation');
        document.getElementById('page-transaction')?.classList.toggle('hide', key !== 'transaction');
        document.getElementById('page-routine')    ?.classList.toggle('hide', key !== 'routine');
        document.getElementById('page-statement')  ?.classList.toggle('hide', key !== 'statement');
        document.getElementById('page-verify')     ?.classList.toggle('hide', key !== 'verify');
      }
    
      function activateTopTab(key){
        const target = topTabs.querySelector(`.tab[data-top="${key}"]`);
        if (!target) return;
    
        // å¤–è§‚æ¿€æ´»
        topTabs.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        target.classList.add('active');
    
        // æ˜¾éš pane
        showPane(key);
    
        // è®°å¿†é¡¶å±‚ tab & inkbar
        sessionStorage.setItem(STORAGE_KEYS.topTab, key);
        updateInkbar();
    
        // è¿›å…¥ç»è¥å®è´¨æ—¶ï¼Œç«‹åˆ»æ¢å¤å­è¡¨å¹¶æ¸²æŸ“
        if (key === 'biz') onBizPageShown();
      }
    
      // ç‚¹å‡»åˆ‡æ¢
      topTabs.addEventListener('click', e=>{
        const t = e.target.closest('.tab'); if(!t) return;
        const key = t.dataset.top; if(!key) return;
        activateTopTab(key);
      });
    
      // âœ… é¦–æ¬¡æ¢å¤ï¼ˆåˆ·æ–°åå…³é”®ä¸€æ­¥ï¼‰
      const savedKey  = sessionStorage.getItem(STORAGE_KEYS.topTab);
      const domActive = topTabs.querySelector('.tab.active');
      const initialKey = savedKey || domActive?.dataset.top || 'biz';
      activateTopTab(initialKey);
    
      // åˆæ¬¡å¸ƒå±€ååŒæ­¥ä¸€æ¬¡ inkbar
      setTimeout(updateInkbar, 0);
    })();
    
    /* ================== çª—å£å°ºå¯¸å˜åŒ–æ—¶åŒæ­¥ inkbar ================== */
    window.addEventListener('resize', updateInkbar);
    
    /* ================== å…­ä¸ªæ“ä½œæŒ‰é’®ï¼šå ä½ç›‘å¬ï¼ˆæ›¿æ¢ä¸ºçœŸå®é€»è¾‘å³å¯ï¼‰ ================== */
    document.getElementById('btnQuick')  ?.addEventListener('click', ()=>console.log('å¿«é€ŸæŸ¥çœ‹å‹¾é€‰ç»“æœ'));
    document.getElementById('btnReset')  ?.addEventListener('click', ()=>console.log('é‡ç½®ç­›é€‰'));
    document.getElementById('btnHead')   ?.addEventListener('click', ()=>console.log('è‡ªå®šä¹‰è¡¨å¤´'));
    document.getElementById('btnDist')   ?.addEventListener('click', ()=>console.log('æµå…¥æµå‡ºåˆ†å¸ƒ'));
    document.getElementById('btnAnalyze')?.addEventListener('click', ()=>console.log('ç”Ÿæˆåˆ†æç»“æœ'));
    document.getElementById('btnFlow')   ?.addEventListener('click', ()=>console.log('ç”Ÿæˆæµæ°´'));
    
    
    /* å¹´åº¦/ç±»å‹ç­›é€‰è”åŠ¨ */
    document.getElementById('yearBalance')?.addEventListener('change',renderBalance);
    document.getElementById('yearIO')?.addEventListener('change',renderIO);
    document.getElementById('ctypeIO')?.addEventListener('change',renderIO);
    
    /* é¦–æ¬¡æ¸²æŸ“ */
    renderBalance();
    renderIO();
    renderCompCats();
    renderCompCharts();
    fillBizTables

    // â€”â€” é€ å‡æ•°é‡ï¼šå¦‚æœä½ æœ‰çœŸå®ç»Ÿè®¡ï¼Œè¿™é‡Œæ›¿æ¢å³å¯ â€”â€” //
    function updateFraudCount(n){
      var el = document.getElementById('fraudCount');
      if (el) el.textContent = Number(n||0);
    }
    // é¦–æ¬¡ç»™ä¸ªé»˜è®¤å€¼ï¼ˆ0ï¼‰ï¼›ä½ å®é™…æ¸²æŸ“å®Œåˆ—è¡¨åå¯å†æ¬¡è°ƒç”¨æ›´æ–°
    updateFraudCount(0);
    
    // â€”â€” ç‚¹å‡»â€œç¬¬ä¸‰æ–¹é…åˆé€ å‡åå•.xlsxâ€ï¼šä½ å¯ä»¥æ”¹æˆå®é™…ä¸‹è½½/é¢„è§ˆé€»è¾‘ â€”â€” //
    document.getElementById('fraudListFile')?.addEventListener('click', ()=>{
      // TODO: æ¢æˆçœŸå®è¡Œä¸ºï¼ˆä¾‹å¦‚æ‰“å¼€é“¾æ¥/è°ƒç”¨ä¸‹è½½æ¥å£ï¼‰
      // window.open('/files/ç¬¬ä¸‰æ–¹é…åˆé€ å‡åå•.xlsx', '_blank');
      console.log('æ‰“å¼€ï¼šç¬¬ä¸‰æ–¹é…åˆé€ å‡åå•.xlsx');
    });
    
    // â€”â€” å¦‚æœåˆ‡æ¢â€œäº¤æ˜“æ˜ç»†/å·¥å•†ä¿¡æ¯â€æˆ–ç­›é€‰åéœ€è¦æ›´æ–°æ•°é‡ï¼Œè°ƒç”¨ updateFraudCount(x) å³å¯ â€”â€” //
    // ä¾‹å¦‚ï¼šåœ¨ fillBizTables() æœ«å°¾ï¼š updateFraudCount(calculatedCount);

    /* ===================== å¢å¼ºç‰ˆ ezï¼šå¤§æ•°æ®é‡ç¨³æ€æ¸²æŸ“ ===================== */
    function ez(domId, option){
      const el = document.getElementById(domId);
      if (!el) return null;
    
      // 1) åˆå§‹åŒ–ï¼ˆcanvas + useDirtyRect æå‡åˆ·æ–°æ•ˆç‡ï¼‰
      const chart = echarts.getInstanceByDom(el) ||
                    echarts.init(el, null, { renderer: 'canvas', useDirtyRect: true });
    
      // 2) æ€§èƒ½ä¸å¥å£®æ€§ç¼ºçœé¡¹ï¼ˆä¸è¦†ç›–ä½ å·²è®¾ç½®çš„åŒåé¡¹ï¼‰
      //    - é‡‡æ · lttbï¼šé™ä½ 700+ ç‚¹å¯¹ DOM çš„å‹åŠ›ä¸”ä¿æŒå½¢çŠ¶
      //    - progressive å¤§å›¾ä¼˜åŒ–ï¼›large æ¨¡å¼
      //    - å…³é—­åŠ¨ç”»ï¼›é¿å…é¦–å¸§å¡/ç™½å±
      //    - è½´æ ‡ç­¾è‡ªåŠ¨é¿è®©ï¼›dataZoom åŠ  throttle é˜²æŠ–
      const enriched = (() => {
        // xAxis / yAxis ç»Ÿä¸€æˆæ•°ç»„å¤„ç†
        const toArr = v => Array.isArray(v) ? v : (v ? [v] : []);
        const xAxes = toArr(option.xAxis).map(ax => ({
          boundaryGap: ax?.boundaryGap ?? false,
          axisTick: { show: false, ...(ax?.axisTick||{}) },
          axisLabel: { hideOverlap: true, interval: 'auto', ...(ax?.axisLabel||{}) },
          ...ax
        }));
        const yAxes = toArr(option.yAxis).map(ay => ({
          min: ay?.min ?? 0, // ä½™é¢/æ”¶æ”¯ä¸€èˆ¬ä» 0 èµ·ï¼Œæ›´ç›´è§‚ï¼›ä½ å·²è‡ªè®¾åˆ™ä¸æ”¹
          axisTick: { show: false, ...(ay?.axisTick||{}) },
          splitLine: { lineStyle:{ color:'#eef2f7' }, ...(ay?.splitLine||{}) },
          ...ay
        }));
    
        const series = (option.series || []).map(s => ({
          showSymbol: false,
          symbol: 'circle',
          symbolSize: 3,
          smooth: false,                 // ä¸è¦è¿‡åº¦å¹³æ»‘ï¼Œä¿æŒâ€œæŠ˜çº¿/è„‰å†²æ„Ÿâ€
          sampling: 'lttb',              // å…³é”®ï¼šå¤§å¹…å‡è½»æ¸²æŸ“è´Ÿæ‹…
          large: true,
          largeThreshold: 2000,
          progressive: 8000,
          progressiveThreshold: 3000,
          clip: true,
          ...(s || {})
        }));
    
        const dataZoom = (option.dataZoom || []).map(z => ({
          throttle: 50,
          // ä¸æ”¹å˜ä½ çš„ç±»å‹/ä½ç½®ï¼Œä»…è¡¥ä¸Šé˜²æŠ–
          ...z
        }));
    
        return {
          animation: false,
          grid: { containLabel: true, ...(option.grid||{}) },
          xAxis: xAxes.length ? (Array.isArray(option.xAxis) ? xAxes : xAxes[0]) : option.xAxis,
          yAxis: yAxes.length ? (Array.isArray(option.yAxis) ? yAxes : yAxes[0]) : option.yAxis,
          series,
          dataZoom,
          ...option
        };
      })();
    
      // 3) æ¸²æŸ“ï¼ˆnotMerge + lazyUpdate æ›´ç¨³ï¼‰
      chart.setOption(enriched, { notMerge: true, lazyUpdate: true });
    
      // 4) å°ºå¯¸ç›‘å¬ï¼ˆé¿å…ç¼©æ”¾/åˆ‡æ¢åç™½å±ï¼‰
      if (!ez._ro) {
        ez._ro = new ResizeObserver(() => {
          try { chart.resize(); } catch(e){}
        });
      }
      ez._ro.observe(el);
    
      return chart;
    }
    /* =============== Routine åŒºåŸŸ =============== */
    const routineMenu=document.getElementById('routineMenu');
    routineMenu.addEventListener('click',e=>{
      const it=e.target.closest('.item'); if(!it) return;
      [...routineMenu.children].forEach(m=>m.classList.remove('active')); it.classList.add('active');
      renderRoutine(it.dataset.code);
    });

    /* æŒ‡æ ‡æ¡ */
    function makeStrip(list){
      const inSum  = list.reduce((s,x)=>s+x.inflow,0);
      const outSum = list.reduce((s,x)=>s+x.outflow,0);
      const set = new Set(list.map(x=>x.name));
      const inflowCompany = new Set(list.filter(x=>x.inflow>0).map(x=>x.name)).size;
      const outflowCompany= new Set(list.filter(x=>x.outflow>0).map(x=>x.name)).size;
      const html = `
        <div class="top-item"><div class="lbl">è¯†åˆ«å¯¹æ‰‹æ–¹æ•°</div><div class="num">${set.size}</div></div>
        <div class="top-item"><div class="lbl">æµå…¥å®¢æˆ·æ•°</div><div class="num">${inflowCompany}</div></div>
        <div class="top-item"><div class="lbl">æµå‡ºå®¢æˆ·æ•°</div><div class="num">${outflowCompany}</div></div>
        <div class="top-item"><div class="lbl">äº¤æ˜“é¢åˆè®¡(ä¸‡)</div><div class="num">${fmtWan(inSum+outSum)}</div></div>
        <div class="top-item"><div class="lbl">æµå…¥é‡‘é¢(ä¸‡)</div><div class="num">${fmtWan(inSum)}</div></div>
        <div class="top-item"><div class="lbl">æµå‡ºé‡‘é¢(ä¸‡)</div><div class="num">${fmtWan(outSum)}</div></div>`;
      document.getElementById('topStrip').innerHTML = html;
    }

    /* Top20 åˆ—è¡¨ + ç¯å½¢å›¾ */
    function renderTop20(list){
      const top20 = list.slice().sort((a,b)=>b.total-a.total).slice(0,20);
      const totalTop = top20.reduce((s,x)=>s+x.total,0);
      document.getElementById('rankTotal').innerText = fmtWan(totalTop)+' ä¸‡';

      const tbody = document.querySelector('#tblTop20 tbody');
      tbody.innerHTML = '';
      const colors=['#f59e0b','#f97316','#ef4444','#22c55e','#3b82f6',
                    '#8b5cf6','#06b6d4','#14b8a6','#eab308','#a855f7'];

      top20.forEach((r,i)=>{
        const color = colors[i%colors.length];
        tbody.insertAdjacentHTML('beforeend',`
      <tr>
        <td><span class="color-dot" style="background:${color}"></span>${i+1}</td>
        <td>${r.name}</td>
        <td><b>${fmtWan(r.total)}</b></td>
        <td style="color:#2563eb">${fmtWan(r.inflow)}</td>
        <td style="color:#ef4444">${fmtWan(r.outflow)}</td>
        <td>${r.txCnt||'-'}</td>
        <td>${r.ctype||'-'}</td>
        <td>${r.relation||'-'}</td>
        <td>${r.industry||'-'}</td>
        <td>${r.capital||'-'}</td>
        <td>${r.foundedDate||'-'}</td>
    </tr>
    `);
      });

      // ç¯å½¢å›¾
      ez('chart-donut',{
        tooltip:{trigger:'item'},
        series:[{
          type:'pie',
          radius:['55%','75%'],
          label:{show:true,formatter:'{d}%'},
          data:top20.map((r,i)=>({
            name:r.name,
            value:r.total,
            itemStyle:{color:colors[i%colors.length]}
          }))
        }]
      });
    }

    /* æ­£æ€æ‹Ÿåˆçº¿ï¼ˆæŒ‰Y=äº¤æ˜“é¢ï¼‰ */
    function gaussianLine(values){
      const n=values.length||1;
      const mean = values.reduce((s,x)=>s+x,0)/n;
      const sd = Math.sqrt(values.reduce((s,x)=>s+(x-mean)*(x-mean),0)/n) || 1;
      const min = Math.max(0, Math.min(...values));
      const max = Math.max(...values);
      const xs = Array.from({length:60},(_,i)=>min+(max-min)*i/59);
      const ys = xs.map(x=> 1/(sd*Math.sqrt(2*Math.PI)) * Math.exp(-0.5*((x-mean)/sd)**2));
      const maxY = Math.max(...ys)||1;
      return {xs, ys: ys.map(y=> y/maxY * (Math.max(...values)*0.6))}; // ç¼©æ”¾
    }
    
    
    /* Routine æ¸²æŸ“ï¼ˆå«åˆ†é¡µï¼‰ */
    let routineFiltered = companies.slice();
    function renderRoutine(code='2.1'){
      const rf=document.getElementById('routineFilters');
      let xName='ç»è¥å¤©æ•°', filterFn=(x)=>true;

      if(code==='2.1'){
        document.getElementById('rTitle').innerText='1. ç»è¥æ—¶é—´è¾ƒçŸ­ Â· ç»“æœ';
        document.getElementById('scatterTitle').innerText='ç»è¥å¤©æ•° vs äº¤æ˜“é‡‘é¢ï¼ˆæ•£ç‚¹+æ­£æ€æ‹Ÿåˆï¼‰';
        rf.innerHTML = `
      <label>ç»è¥æ—¶é—´ï¼š</label>
      <select class="select" id="rLayer">
        <option value="all">å…¨éƒ¨</option>
        <option value="lt1"><1å¹´</option>
        <option value="1-2">1-2å¹´</option>
        <option value="ge3">â‰¥3å¹´</option>
    </select>
      <label>äº¤æ˜“å¹´åº¦ï¼š</label>
      <select class="select" id="rYear">
        <option value="all">å…¨éƒ¨</option>
        <option>2022</option>
        <option>2023</option>
        <option>2024</option>
    </select>
      <label>å®¢æˆ·æ ‡ç­¾ï¼š</label>
      <select class="select" id="rCtype">
        <option value="all">å…¨éƒ¨</option>
        <option>å®¢æˆ·</option>
        <option>ä¾›åº”å•†</option>
        <option>å‘˜å·¥</option>
    </select>
      <label>é‡‘é¢èŒƒå›´ï¼š</label>
      <select class="select" id="rAmt">
        <option value="all">å…¨éƒ¨</option>
        <option value="le100">â‰¤100ä¸‡</option>
        <option value="100-500">100-500ä¸‡</option>
        <option value="gt500">â‰¥500ä¸‡</option>
    </select>
      <button class="btn" id="btnApplyRoutine">åº”ç”¨ç­›é€‰</button>
    `;
        filterFn = (r) => {
          const layer = document.getElementById('rLayer')?.value || 'all';
          const year = document.getElementById('rYear')?.value || 'all';
          const ctype = document.getElementById('rCtype')?.value || 'all';
          const amt = document.getElementById('rAmt')?.value || 'all';

          if (layer === 'lt1' && r.foundedDays >= 365) return false;
          if (layer === '1-2' && !(r.foundedDays >= 365 && r.foundedDays < 730)) return false;
          if (layer === 'ge3' && r.foundedDays < 1095) return false;
          if (year !== 'all' && !r.foundedDate.startsWith(year)) return false;
          if (ctype !== 'all' && r.ctype !== ctype) return false;
          if (amt === 'le100' && r.total > 100) return false;
          if (amt === '100-500' && !(r.total >= 100 && r.total <= 500)) return false;
          if (amt === 'gt500' && r.total <= 500) return false;

          return true;
        };
        xName = 'ç»è¥å¤©æ•°';
      }else if(code==='2.2'){
        document.getElementById('rTitle').innerText='2. ç¤¾ä¿ç¼´çº³äººæ•°è¾ƒå°‘ Â· ç»“æœ';
        document.getElementById('scatterTitle').innerText='ç¼´çº³äººæ•° vs äº¤æ˜“é‡‘é¢ï¼ˆæ•£ç‚¹+æ­£æ€æ‹Ÿåˆï¼‰';
        rf.innerHTML = `
      <label>ç¤¾ä¿äººæ•°ï¼š</label>
      <select class="select" id="rSocial">
        <option value="all">å…¨éƒ¨</option>
        <option value="lt50"><50</option>
        <option value="50-99">50-99</option>
        <option value="ge100">â‰¥100</option>
      </select>
      <label>äº¤æ˜“å¹´åº¦ï¼š</label>
      <select class="select" id="rYear">
        <option value="all">å…¨éƒ¨</option>
        <option>2022</option>
        <option>2023</option>
        <option>2024</option>
      </select>
      <label>å®¢æˆ·æ ‡ç­¾ï¼š</label>
      <select class="select" id="rCtype">
        <option value="all">å…¨éƒ¨</option>
        <option>å®¢æˆ·</option>
        <option>ä¾›åº”å•†</option>
        <option>å‘˜å·¥</option>
      </select>
      <label>é‡‘é¢èŒƒå›´ï¼š</label>
      <select class="select" id="rAmt">
        <option value="all">å…¨éƒ¨</option>
        <option value="le100">â‰¤100ä¸‡</option>
        <option value="100-500">100-500ä¸‡</option>
        <option value="gt500">â‰¥500ä¸‡</option>
      </select>
      <button class="btn" id="btnApplyRoutine">åº”ç”¨ç­›é€‰</button>
    `;
    filterFn = (r) => {
      const social = document.getElementById('rSocial')?.value || 'all';
      const year = document.getElementById('rYear')?.value || 'all';
      const ctype = document.getElementById('rCtype')?.value || 'all';
      const amt = document.getElementById('rAmt')?.value || 'all';

      if (social === 'lt50' && r.employees >= 50) return false;
      if (social === '50-99' && !(r.employees >= 50 && r.employees <= 99)) return false;
      if (social === 'ge100' && r.employees < 100) return false;
      if (year !== 'all' && !r.foundedDate.startsWith(year)) return false;
      if (ctype !== 'all' && r.ctype !== ctype) return false;
      if (amt === 'le100' && r.total > 100) return false;
      if (amt === '100-500' && !(r.total >= 100 && r.total <= 500)) return false;
      if (amt === 'gt500' && r.total <= 500) return false;

      return true;
    };
    xName = 'ç¼´çº³äººæ•°';
      }else{
        document.getElementById('rTitle').innerText='3. ä¸ºä¸ªäººæˆ–ä¸ªä½“å·¥å•†æˆ· Â· ç»“æœ';
        document.getElementById('scatterTitle').innerText='ä¸»ä½“ç¼–å· vs äº¤æ˜“é‡‘é¢ï¼ˆæ•£ç‚¹+æ­£æ€æ‹Ÿåˆï¼‰';
        rf.innerHTML=`
        <label>ä¸»ä½“ï¼š</label>
      <select class="select" id="pType">
        <option value="all">å…¨éƒ¨</option>
        <option>ä¸ªäºº</option>
        <option>ä¸ªä½“å·¥å•†æˆ·</option>
      </select>
      <label>äº¤æ˜“å¹´åº¦ï¼š</label>
      <select class="select" id="rYear">
        <option value="all">å…¨éƒ¨</option>
        <option>2022</option>
        <option>2023</option>
        <option>2024</option>
      </select>
      <label>å®¢æˆ·æ ‡ç­¾ï¼š</label>
      <select class="select" id="rCtype">
        <option value="all">å…¨éƒ¨</option>
        <option>å®¢æˆ·</option>
        <option>ä¾›åº”å•†</option>
        <option>å‘˜å·¥</option>
      </select>
      <label>é‡‘é¢èŒƒå›´ï¼š</label>
      <select class="select" id="rAmt">
        <option value="all">å…¨éƒ¨</option>
        <option value="le100">â‰¤100ä¸‡</option>
        <option value="100-500">100-500ä¸‡</option>
        <option value="gt500">â‰¥500ä¸‡</option>
      </select>
      <button class="btn" id="btnApplyRoutine">åº”ç”¨ç­›é€‰</button>
    `;
    filterFn = (r) => {
      const pType = document.getElementById('pType')?.value || 'all';
      const year = document.getElementById('rYear')?.value || 'all';
      const ctype = document.getElementById('rCtype')?.value || 'all';
      const amt = document.getElementById('rAmt')?.value || 'all';

      if (pType !== 'all' && r.type !== pType) return false;
      if (year !== 'all' && !r.foundedDate.startsWith(year)) return false;
      if (ctype !== 'all' && r.ctype !== ctype) return false;
      if (amt === 'le100' && r.total > 100) return false;
      if (amt === '100-500' && !(r.total >= 100 && r.total <= 500)) return false;
      if (amt === 'gt500' && r.total <= 500) return false;

      return true;
    };
    xName = 'ä¸»ä½“ç¼–å·';
  
      }

      function apply(){
        let list = companies.slice();
        if(code==='2.3'){ list = list.filter(r=>r.type!=='å…¬å¸'); }
        list = list.filter(filterFn);

        routineFiltered = list;
        currentRoutinePage = 1;

        // æŒ‡æ ‡æ¡
        makeStrip(list);

        // æ•£ç‚¹ + æ‹Ÿåˆ
        const points = list.map((r,idx)=>{
          const x = (code==='2.1') ? r.foundedDays : (code==='2.2'? r.employees : idx+1);
          const y = r.total;
          const size = Math.max(6, Math.sqrt(y)); // äº¤æ˜“é¢å¤§çš„ç‚¹æ›´å¤§
          return {name:r.name, value:[x,y], symbolSize:size, extra:r};
        });
        const fit = gaussianLine(list.map(r=>r.total));
        ez('chart-scatter',{
          tooltip:{formatter:(p)=>{
            const d=p.data.extra;
            const xVal = (code==='2.1')? `${d.foundedDays} å¤©` : (code==='2.2'? `${d.employees} äºº` : `#${p.dataIndex+1}`);
            return `${d.name}<br/>Xï¼š${xVal}<br/>æµå…¥ï¼š${fmtWan(d.inflow)} ä¸‡<br/>æµå‡ºï¼š${fmtWan(d.outflow)} ä¸‡<br/>äº¤æ˜“é¢ï¼š<b>${fmtWan(d.total)} ä¸‡</b><br/>äº¤æ˜“ç¬”æ•°ï¼š${d.txCnt}`;
          }},
          xAxis:{name:xName,type:'value',axisLine:{onZero:false}},
          yAxis:{name:'äº¤æ˜“é‡‘é¢(ä¸‡)',type:'value'},
          series:[
            {type:'scatter',data:points,emphasis:{scale:1.15}},
            {type:'line',name:'æ­£æ€æ‹Ÿåˆ',data:fit.xs.map((x,i)=>[x,fit.ys[i]]),smooth:true,showSymbol:false,areaStyle:{opacity:.08}}
          ]
        });

        // Top20
        renderTop20(list);

        // æ˜ç»†è¡¨ + åˆ†é¡µ
        renderRoutineTable();
      }

      document.getElementById('routineFilters').onclick=(e)=>{ if(e.target.id==='btnApplyRoutine') apply(); };
      apply();
    }
let routineView = 'flow'; // é»˜è®¤æµæ°´è§†å›¾

document.getElementById('routineTabs').addEventListener('click', e=>{
  const tab = e.target.closest('.table-tab');
  if(!tab) return;
  [...routineTabs.children].forEach(x=>x.classList.remove('active'));
  tab.classList.add('active');
  routineView = tab.dataset.view;
  renderRoutineTable(); // åˆ‡æ¢åé‡ç»˜è¡¨æ ¼
});

function renderRoutineTable(){
  const list = routineFiltered.slice();
  const pageItems = paginate(list,currentRoutinePage);
  const thead = document.querySelector('#tblRoutineDetail thead');
  const tbody = document.querySelector('#tblRoutineDetail tbody');

  if(routineView==='flow'){ // æµæ°´è§†å›¾
    thead.innerHTML = `
      <tr>
        <th>æœ¬æ–¹åç§°</th><th>æœ¬æ–¹è´¦å·</th><th>å¯¹æ–¹åç§°</th><th>äº¤æ˜“æ—¥æœŸ</th>
        <th>äº¤æ˜“æ—¶é—´</th><th>å¸ç§</th><th>æµå…¥é‡‘é¢</th><th>æµå‡ºé‡‘é¢</th>
        <th>äº¤æ˜“åä½™é¢</th><th>ç­‰å€¼äººæ°‘å¸ä½™é¢</th><th>äº¤æ˜“ç±»å‹</th>
        <th>æµæ°´è¯†åˆ«å·</th><th>æ‘˜è¦</th><th>æµæ°´æ˜ç»†å°½è°ƒå¤‡æ³¨</th>
        <th>å…³è”å…³ç³»</th><th>æ‰€å±é›†å›¢</th><th>å¯¹æ‰‹æ–¹ç±»å‹</th><th>é”€å”®ç±»åˆ«</th>
      </tr>`;
    tbody.innerHTML = pageItems.map(d=>`
      <tr>
        <td>${d.name}</td><td>6222****${d.id}</td><td>å¯¹æ–¹${d.id}</td>
        <td>2024-0${(d.id%9)+1}-15</td><td>${String(8+d.id%10)}:${String(d.id%60).padStart(2,'0')}</td>
        <td>CNY</td>
        <td style="color:#2563eb">${fmtWan(d.inflow)}</td>
        <td style="color:#ef4444">${fmtWan(d.outflow)}</td>
        <td>${fmtWan(d.total-d.outflow)}</td><td>${fmtWan(d.total)}</td>
        <td>è½¬è´¦</td><td>TX${10000+d.id}</td>
        <td>æ‘˜è¦${d.id}</td><td>å¤‡æ³¨${d.id}</td><td>${d.relation}</td>
        <td>é›†å›¢${d.id%5+1}</td><td>${d.ctype}</td><td>${d.sales}</td>
      </tr>`).join('');
  } else { // å¯¹æ‰‹æ–¹è§†å›¾
    thead.innerHTML = `
      <tr>
        <th>å¯¹æ‰‹æ–¹åç§°</th><th>æµå…¥æ€»é¢</th><th>æµå‡ºæ€»é¢</th><th>äº¤æ˜“æ€»é¢</th>
        <th>å¼‚å¸¸äº¤æ˜“æ€»é¢</th><th>å æ¯”1</th><th>å æ¯”2</th>
        <th>å¼‚å¸¸äº¤æ˜“ç¬”æ•°</th><th>äº¤æ˜“æ¬¡æ•°</th><th>å¯¹æ‰‹æ–¹ç±»å‹</th>
        <th>å…³è”å…³ç³»</th><th>é”€å”®ç±»åˆ«</th><th>é‡‡è´­ç±»åˆ«</th>
        <th>èŒä½</th><th>æ‰€å±é›†å›¢</th>
      </tr>`;
    tbody.innerHTML = pageItems.map(d=>`
      <tr>
        <td>${d.name}</td>
        <td style="color:#2563eb">${fmtWan(d.inflow)}</td>
        <td style="color:#ef4444">${fmtWan(d.outflow)}</td>
        <td><b>${fmtWan(d.total)}</b></td>
        <td>${fmtWan(d.outflow*0.15)}</td>
        <td>${(Math.random()*10).toFixed(2)}%</td>
        <td>${(Math.random()*5).toFixed(2)}%</td>
        <td>${Math.floor(d.txCnt*0.1)}</td>
        <td>${d.txCnt}</td><td>${d.ctype}</td><td>${d.relation}</td>
        <td>${d.sales}</td><td>${d.purchase}</td><td>${d.job}</td>
        <td>é›†å›¢${d.id%5+1}</td>
      </tr>`).join('');
  }

  renderPagination('pagination-routine', list.length, currentRoutinePage, 'gotoRoutine');
}

function gotoRoutine(p){
  currentRoutinePage=p;
  renderRoutineTable();
}

// åˆå§‹åŒ–
renderRoutine('2.1');

    /* ===== é¡¶éƒ¨é¡µé¢åˆ‡æ¢ + åˆ·æ–°ä¿æŒå½“å‰é¡µ ===== */
    /* ===== é¡¶éƒ¨é¡µé¢åˆ‡æ¢ + åˆ·æ–°ä¿æŒå½“å‰é¡µ ===== */
    const TAB_KEY   = 'topTabs.active';
    const PANE_SEL  = '.tab-pane';
    const ID_PREFIX = 'pane-';
    
    function setPageVisible(key){
      document.querySelectorAll(PANE_SEL).forEach(el=>{
        el.classList.add('hide');
        el.classList.remove('active');
      });
      const tgt = document.getElementById(ID_PREFIX + key);
      if (tgt){
        tgt.classList.remove('hide');
        tgt.classList.add('active');
      }
    }
    
    function setTabActive(key){
      document.querySelectorAll('#topTabs .tab')
        .forEach(el=>el.classList.toggle('active', el.dataset.top === key));
    }
    
    function updateInkbar(key){
      const bar = document.getElementById('inkbar');
      const act = document.querySelector(`#topTabs .tab[data-top="${key}"]`);
      if (!bar || !act) return;
      requestAnimationFrame(()=>{
        bar.style.width = act.offsetWidth + 'px';
        bar.style.left  = act.offsetLeft + 'px';
      });
    }
    
    function activate(key){
      setTabActive(key);
      setPageVisible(key);
      updateInkbar(key);
      localStorage.setItem(TAB_KEY, key);
      setTimeout(()=>window.dispatchEvent(new Event('resize')),50);
    }
    
    document.getElementById('topTabs')?.addEventListener('click', e=>{
      const t = e.target.closest('.tab'); if(!t) return;
      activate(t.dataset.top);
    });
    
    document.addEventListener('DOMContentLoaded', ()=>{
      document.querySelectorAll(PANE_SEL).forEach(el=>el.classList.add('hide'));
      const saved = localStorage.getItem(TAB_KEY) || 'account';
      activate(saved);
    });
    
    window.addEventListener('load', ()=>{
      updateInkbar(localStorage.getItem(TAB_KEY) || 'account');
    });
  </script>
</body>
</html>
